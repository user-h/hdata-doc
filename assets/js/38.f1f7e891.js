(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{366:function(e,o,t){"use strict";t.r(o);var a=t(3),r=Object(a.a)({},(function(){var e=this,o=e._self._c;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("p",[o("strong",[e._v("理论")])]),e._v(" "),o("ul",[o("li",[e._v("消息队列\n"),o("ul",[o("li",[e._v("异步(两个不用同时在线)")]),e._v(" "),o("li",[e._v("削峰")])])])]),e._v(" "),o("p",[e._v("点对点模式")]),e._v(" "),o("p",[e._v("发布订阅模式")]),e._v(" "),o("blockquote",[o("p",[e._v("消费者拉取(kafka)(缺点：长轮询)(优点：消费者决定速率)\n消息队列推送")])]),e._v(" "),o("p",[e._v("==在此之前,要安装好jdk和Zookeeper集群==\n"),o("s",[e._v("安装位置:我猜是和Zookeeper安装的机器一样")])]),e._v(" "),o("h3",{attrs:{id:"_1-下载安装"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载安装"}},[e._v("#")]),e._v(" 1.下载安装")]),e._v(" "),o("ul",[o("li",[e._v("在官网下载(最新版本?)(一般不会出现版本兼容问题): "),o("code",[e._v("kafka_2.12-2.4.1.tgz")])]),e._v(" "),o("li",[e._v("上传到虚拟机")]),e._v(" "),o("li",[e._v("解压安装: "),o("code",[e._v("tar -zxvf /soft/software/kafka_2.12-2.4.1.tgz -C /soft/module/")])]),e._v(" "),o("li",[e._v("重命名: "),o("code",[e._v("mv kafka_2.12-2.4.1 kafka")])])]),e._v(" "),o("h3",{attrs:{id:"_2-修改配置文件"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_2-修改配置文件"}},[e._v("#")]),e._v(" 2.修改配置文件")]),e._v(" "),o("ol",[o("li",[e._v("在kafka目录下新建文件夹: "),o("code",[e._v("mkdir logs")])]),e._v(" "),o("li",[e._v("修改配置文件: "),o("code",[e._v("cd config/")]),e._v(" "),o("code",[e._v("vim server.properties")])])]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("#broker 的全局唯一编号，不能重复\nbroker.id=0\n#删除 topic 功能使能彻底删除\ndelete.topic.enable=true\n#kafka 运行日志存放的路径\nlog.dirs=/soft/module/kafka/logs\n#配置连接Zookeeper 集群地址\nzookeeper.connect=hadoop101:2181,hadoop102:2181,hadoop103:2181\n\n#后面不是必须配置的内容\n#处理网络请求的线程数量\nnum.network.threads=3\n#用来处理磁盘 IO 的线程数量\nnum.io.threads=8\n#发送套接字的缓冲区大小\nsocket.send.buffer.bytes=102400 \n#接收套接字的缓冲区大小\nsocket.receive.buffer.bytes=102400 \n#请求套接字的缓冲区大小\nsocket.request.max.bytes=104857600\n#topic 在当前 broker 上的分区个数\nnum.partitions=1\n#用来恢复和清理 data 下数据的线程数量\nnum.recovery.threads.per.data.dir=1 \n#segment 文件保留的最长时间，超时将被删除\nlog.retention.hours=168\n")])])]),o("ol",{attrs:{start:"3"}},[o("li",[e._v("配置环境变量\n"),o("code",[e._v("sudo vim /etc/profile")])])]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("#KAFKA_HOME 环境变量配置\nexport KAFKA_HOME=/soft/module/kafka export PATH=$PATH:$KAFKA_HOME/bin\n")])])]),o("p",[o("code",[e._v("source /etc/profile")]),e._v("\n4. 分发文件\n5. 修改集群其它机器kafka配置\n"),o("code",[e._v("分别在hadoop103和hadoop104上修改配置文件/opt/module/kafka/config/server.properties中的broker.id=1、broker.id=2")]),e._v("\n注：broker.id不得重复")]),e._v(" "),o("h3",{attrs:{id:"_3-启动集群"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_3-启动集群"}},[e._v("#")]),e._v(" 3.启动集群")]),e._v(" "),o("p",[e._v("先启动Zookeeper")]),e._v(" "),o("ol",[o("li",[e._v("单机启动\n启动: "),o("code",[e._v("bin/kafka-server-start.sh\t-daemon config/server.properties")]),e._v("\n关闭: "),o("code",[e._v("bin/kafka-server-stop.sh stop")])]),e._v(" "),o("li",[e._v("集群启动\n启动脚本")])]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("for i in hadoop101 hadoop102 hadoop103 do\necho \"========== $i ==========\"\nssh\t$i\t'/soft/module/kafka/bin/kafka-server-start.sh\n/soft/module/kafka/config/server.properties' done\n")])])]),o("ol",{attrs:{start:"3"}},[o("li")]),e._v(" "),o("h3",{attrs:{id:"_4-kafka命令行操作"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_4-kafka命令行操作"}},[e._v("#")]),e._v(" 4.kafka命令行操作")]),e._v(" "),o("ol",[o("li",[o("p",[e._v("查看当前服务器中的所有 topic\n"),o("code",[e._v("bin/kafka-topics.sh\t--zookeeper hadoop1:2181 --list")])])]),e._v(" "),o("li",[o("p",[e._v("创建 topic\n"),o("code",[e._v("bin/kafka-topics.sh --zookeeper hadoop1:2181 --create --replication-factor 3 --partitions 1 --topic first")]),e._v("\n--topic 定义 topic 名\n--replication-factor\t定义副本数\n--partitions\t定义分区数")])]),e._v(" "),o("li",[o("p",[e._v("删除 topic\n"),o("code",[e._v("bin/kafka-topics.sh --zookeeper hadoop1:2181 --delete --topic first")]),e._v("\n需要 server.properties 中设置 delete.topic.enable=true 否则只是标记删除。")])]),e._v(" "),o("li",[o("p",[e._v("发送消息")])])]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("bin/kafka-console-producer.sh --broker-list hadoop1:9092 --topic first\n>hello world\n>atguigu\tatguigu\n")])])]),o("ol",{attrs:{start:"5"}},[o("li",[e._v("消费消息")])]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("bin/kafka-console-consumer.sh \\\n--bootstrap-server hadoop1:9092 --topic first\n\nbin/kafka-console-consumer.sh \\\n--bootstrap-server hadoop1:9092 --from-beginning --topic first\n\n")])])]),o("ol",{attrs:{start:"6"}},[o("li",[e._v("查看某个Topic 的详情\n"),o("code",[e._v("bin/kafka-topics.sh --zookeeper hadoop1:2181 --describe --topic first")])]),e._v(" "),o("li",[e._v("修改分区数\n"),o("code",[e._v("bin/kafka-topics.sh --zookeeper hadoop1:2181 --alter --topic first --partitions 6")])])])])}),[],!1,null,null,null);o.default=r.exports}}]);