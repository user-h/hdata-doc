---
title: Spring Boot相关
date: 2022-02-28 08:54:08
permalink: /pages/1e9420/
---


## 知识点

### Spring Boot项目中读取application配置文件中配置

- 使用@Value方式

```java
@Value("${spring.kafka.topic}")
private String topic;
```

- 使用Environment方式

```java
@Autowired  
private Environment env;  
      
env.getProperty("spring.kafka.topic");
```

- @ConfigurationProperties(prefix = "") 注解

```java
1、在application.yml中添加配置
application:
  serverConfig:
    address: localhost
    port: 22
    username: geiri
    password: 12345678
    
2.建配置类
package com.pn.ebs.config;
 
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.stereotype.Component;
 
@Component
@ConfigurationProperties(prefix = "application")
public class ApplicationProperties {
 
    private ServerConfig serverConfig = new ServerConfig();
 
    public ServerConfig getServerConfig() {
        return serverConfig;
    }
    public final class ServerConfig{
        private String address;
        private String port;
        private String username;
        private String password;
        // geter/setter 此处略
    }
 
}
```
### Spring Boot实体类时间格式化

```java
// 返回时间格式
@JsonFormat(pattern="yyyy-MM-dd HH:mm:ss",timezone="GMT+8")

// 传入时间格式
@DateTimeFormat(pattern ="yyyy-MM-dd")
```

### 事务注解

> Spring Boot中实现事务没有额外的Jar包，还是基本的数据库访问包，比如mybatis

**注解事务@Transactional**
```java
@Service
public class PersonService {
    @Resource
    private PersonMapper personMapper;

    @Resource
    private CompanyMapper companyMapper;

    @Transactional(rollbackFor = {RuntimeException.class, Error.class})
    public void saveOne(Person person) {
        Company company = new Company();
        company.setName("tenmao:" + person.getName());
        companyMapper.insertOne(company);
        personMapper.insertOne(person);
    }
}
```

**注解属性**

* rollbackFor：触发回滚的异常，默认是RuntimeException和Error
* isolation: 事务的隔离级别，默认是Isolation.DEFAULT也就是数据库自身的默认隔离级别，比如MySQL是ISOLATION_REPEATABLE_READ可重复读

> 这样就可以了，不需要其他配置。 <br>
ps：网络上还说要在@SpringBootApplication上添加注解@EnableTransactionManagement，已经不需要了

::: right
[原文](https://www.jianshu.com/p/9b5eb43236cc)
:::







### 国内最好的maven repository

方法1：全局配置:修改maven根目录下的conf文件夹中的setting.xml文件，内容如下：

```xml
<mirrors>
    <mirror>
      <id>alimaven</id>
      <name>aliyun maven</name>
      <url>http://maven.aliyun.com/nexus/content/groups/public/</url>
      <mirrorOf>central</mirrorOf>        
    </mirror>
  </mirrors>
```

方法2：单项目配置: pom.xml文件里添加

```xml
<repositories>  
        <repository>  
            <id>alimaven</id>  
            <name>aliyun maven</name>  
            <url>http://maven.aliyun.com/nexus/content/groups/public/</url>  
            <releases>  
                <enabled>true</enabled>  
            </releases>  
            <snapshots>  
                <enabled>false</enabled>  
            </snapshots>  
        </repository>  
</repositories> 
===========================================
<repositories>
        <repository>
            <id>central</id>
            <name>aliyun maven</name>
            <url>http://maven.aliyun.com/nexus/content/groups/public/</url>
            <layout>default</layout>
            <!-- 是否开启发布版构件下载 -->
            <releases>
                <enabled>true</enabled>
            </releases>
            <!-- 是否开启快照版构件下载 -->
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
    </repositories> 
```
