---
title: é€‚é…å™¨æ¨¡å¼ä¸å¤–è§‚æ¨¡å¼
date: 2022-07-18 23:40:41
permalink: /pages/c7cf8b/
---
## é€‚é…å™¨æ¨¡å¼ï¼ˆadaptor patternï¼‰

<span style='color:red'><b>é€‚é…å™¨æ¨¡å¼</b> å°†ä¸€ä¸ªç±»çš„æ¥å£ï¼Œè½¬æ¢æˆå®¢æˆ·æœŸæœ›çš„å¦ä¸€ä¸ªæ¥å£ã€‚é€‚é…å™¨è®©åŸæœ¬æ¥å£ä¸å…¼å®¹çš„ç±»å¯ä»¥åˆä½œæ— é—´ã€‚</span>

#### é—®é¢˜æå‡ºï¼šç«é¸¡è½¬æ¢å™¨

å‡å¦‚æˆ‘ä»¬åœ¨è·¯ä¸Šé‡è§ä¸€ä¸ªNPCï¼Œå¿…é¡»ç»™ä»–ä¸€åªé¸­å­æ‰èƒ½å®Œæˆä»»åŠ¡ã€‚ä½†æ˜¯æˆ‘ä»¬åªæœ‰ä¸€åªç«é¸¡ï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦é€‚é…å™¨æ¨¡å¼æ¥é€‚é…ä»–çš„éœ€æ±‚ã€‚ğŸ˜•ğŸ¤£

#### ç±»å›¾ï¼ˆå¯¹è±¡é€‚é…å™¨ï¼‰
<br/>

é‡‡ç”¨ç»„åˆçš„æ–¹å¼

```mermaid
classDiagram
  class Target{
    <<Interface>>
    +request()
  }
  class Adaptee{
    +specificRequest()
  }
  class Adaptor{
    Adaptee adaptee
    +request()
  }
  
  class Client{
  }

  Target <|.. Adaptor : å®ç°
  Adaptee <-- Adaptor : å…³è”
  Target <-- Client : å…³è”
```

#### ä»£ç å®ç°

<code-group>
  <code-block title="é¸­å­ç±»" active>
  ```java
  / é¸­å­æ¥å£
  public interface Duck {
      public void quack();
      public void fly();
  }
  
  class MallardDuck implements Duck{
  
      @Override
      public void quack() {
          System.out.println("ç»¿å¤´é¸­å«");
      }
  
      @Override
      public void fly() {
          System.out.println("ç»¿å¤´é¸­é£");
      }
  }
  ```
  </code-block>

  <code-block title="ç«é¸¡ç±»">
  ```java
  /**
   * ç«é¸¡æ¥å£
   */
  public interface Turkey {
      public void gobble();   // ç«é¸¡å’¯å’¯å«
      public void fly();      // ç«é¸¡é£
  }
  
  /**
   * ç«é¸¡å®ç°
   */
  class WildTurkey implements Turkey {
  
      @Override
      public void gobble() {
          System.out.println("ç«é¸¡å’¯å’¯å«");
      }
  
      @Override
      public void fly() {
          System.out.println("ç«é¸¡é£è¡Œ");
      }
  }
  ```
  </code-block>
  
  <code-block title="é€‚é…å™¨">
  ```java
  public class TurkeyAdaptor implements Duck {
      Turkey turkey;
  
      public TurkeyAdaptor(Turkey turkey) {
          this.turkey = turkey;
      }
  
      @Override
      public void quack() {
          turkey.gobble();
      }
  
      @Override
      public void fly() {
          turkey.fly();
      }
  }
  ```
  </code-block>
  
  <code-block title="æµ‹è¯•ç±»">
  ```java
  public class Main {
      public static void main(String[] args) {
          MallardDuck duck = new MallardDuck();   // åˆ›å»ºä¸€åªé¸­å­
          WildTurkey turkey = new WildTurkey();   // åˆ›å»ºä¸€åªç«é¸¡
  
          Main main = new Main();
          main.testDuck(duck);
  //        main.testDuck(turkey);
          TurkeyAdaptor turkeyAdaptor = new TurkeyAdaptor(turkey);
          main.testDuck(turkeyAdaptor);
      }
  
      /**
       * é¸­å­æµ‹è¯•ç±»
       * @param duck
       */
      public void testDuck(Duck duck) {
          duck.quack();
          duck.fly();
      }
  }
  ```
  </code-block>
</code-group>

#### å¤šç»§æ‰¿æ—¶ç±»é€‚é…å™¨ï¼ˆJavaæ— æ³•å®ç°ï¼‰

é‡‡ç”¨ç»§æ‰¿çš„å½¢å¼<br/>

```mermaid
classDiagram
  class Target{
    +request()
  }
  class Adaptee{
    +specificRequest()
  }
  class Adaptor{
    Adaptee adaptee
    +request()
  }
  
  class Client{
  }

  Target <|-- Adaptor : ç»§æ‰¿
  Adaptee <|-- Adaptor : ç»§æ‰¿
  Target <-- Client : å…³è”
```

#### çœŸå®ä¸–ç•Œï¼ˆJavaï¼‰çš„é€‚é…å™¨

##### é—®é¢˜æå‡º

1. æ—§ä¸–ç•Œçš„æšä¸¾å™¨
    > å¦‚æœä½ å·²ç»ä½¿ç”¨è¿‡Javaï¼Œå¯èƒ½è®°å¾—æ—©æœŸçš„é›†åˆ(collection)ç±»å‹ï¼ˆä¾‹å¦‚ï¼šVectorã€Stackã€Hashtable)éƒ½å®ç°äº†ä¸€ä¸ªåä¸ºelementsï¼ˆï¼‰çš„æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªEnumerationï¼ˆä¸¾ï¼‰ã€‚è¿™ä¸ªEnumerationæ¥å£å¯ä»¥é€ä¸€èµ°è¿‡æ­¤é›†åˆå†…çš„æ¯ä¸ªå…ƒç´ ï¼Œè€Œæ— éœ€çŸ¥é“å®ƒä»¬åœ¨é›†åˆå†…æ˜¯å¦‚ä½•è¢«ç®¡ç†çš„ã€‚

2. æ–°ä¸–ç•Œçš„è¿­ä»£å™¨
    > å½“Sunæ¨å‡ºæ›´æ–°åçš„é›†åˆç±»æ—¶ï¼Œå¼€å§‹ä½¿ç”¨äº†Iteratorï¼ˆè¿­ä»£å™¨ï¼‰æ¥å£ï¼Œè¿™ä¸ªæ¥å£å’Œæšä¸¾æ¥å£å¾ˆåƒï¼Œéƒ½å¯ä»¥è®©ä½ éå†æ­¤é›†åˆç±»å‹å†…çš„æ¯ä¸ªå…ƒç´ ï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œè¿­ä»£å™¨è¿˜æä¾›äº†åˆ é™¤å…ƒç´ çš„èƒ½åŠ›ã€‚

3. é—ç•™ä»£ç æš´éœ²äº†æšä¸¾å™¨æ¥å£ï¼Œä½†æ˜¯æ–°ä»£ç åªå¸Œæœ›ç”¨è¿­ä»£å™¨ã€‚æƒ³è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦æ„é€ ä¸€ä¸ªé€‚é…å™¨ã€‚

##### å°†æšä¸¾é€‚é…åˆ°è¿­ä»£å™¨

ç”±äº Enumeration ä¸ºâ€œåªè¯»â€æ¥å£ï¼Œæ— æ³•å®ç° remove() çš„æ•ˆæœï¼Œåªèƒ½å…ˆåœ¨ remove ä¸­æŠ›å‡ºå¼‚å¸¸ã€‚

```mermaid
classDiagram
  class Iterator{
    <<Interface>>
    +hasNext()
    +next()
    +remove()
  }
  class Enumeration{
    <<Interface>>
    +hasMoreElements()
    +nextElement()
  }
  
  class EnumerationIterator{
    Enumeration enumeration
    +hasNext()
    +next()
    +remove()
  }

  Iterator <|.. EnumerationIterator : å®ç°
  Enumeration <-- EnumerationIterator : å…³è”
```

## å¤–è§‚æ¨¡å¼

<span style='color:red'><b>å¤–è§‚æ¨¡å¼</b> æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œç”¨æ¥è®¿é—®å­ç³»ç»Ÿä¸­çš„ä¸€ç¾¤æ¥å£ã€‚å¤–è§‚å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè®©å­ç³»ç»Ÿæ›´å®¹æ˜“ä½¿ç”¨ã€‚</span>


