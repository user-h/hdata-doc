<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Oracle相关知识杂记 | 唐宋元明清</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/hdata-doc/img/favicon.ico">
    <meta name="description" content="">
    <meta name="keywords" content="vuepress,theme,blog,vdoing">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/hdata-doc/assets/css/0.styles.ce16c74b.css" as="style"><link rel="preload" href="/hdata-doc/assets/js/app.37e4fbb6.js" as="script"><link rel="preload" href="/hdata-doc/assets/js/2.82afd9cb.js" as="script"><link rel="preload" href="/hdata-doc/assets/js/54.ed81b599.js" as="script"><link rel="prefetch" href="/hdata-doc/assets/js/10.7b061388.js"><link rel="prefetch" href="/hdata-doc/assets/js/11.3d84b622.js"><link rel="prefetch" href="/hdata-doc/assets/js/12.f524e450.js"><link rel="prefetch" href="/hdata-doc/assets/js/13.b3ff7d26.js"><link rel="prefetch" href="/hdata-doc/assets/js/14.3675e190.js"><link rel="prefetch" href="/hdata-doc/assets/js/15.676eac9f.js"><link rel="prefetch" href="/hdata-doc/assets/js/16.c546644f.js"><link rel="prefetch" href="/hdata-doc/assets/js/17.d80c3241.js"><link rel="prefetch" href="/hdata-doc/assets/js/18.bfa024db.js"><link rel="prefetch" href="/hdata-doc/assets/js/19.c4ebe893.js"><link rel="prefetch" href="/hdata-doc/assets/js/20.0c06c705.js"><link rel="prefetch" href="/hdata-doc/assets/js/21.e586d4fc.js"><link rel="prefetch" href="/hdata-doc/assets/js/22.d4747bce.js"><link rel="prefetch" href="/hdata-doc/assets/js/23.cfa91ca4.js"><link rel="prefetch" href="/hdata-doc/assets/js/24.77c960d1.js"><link rel="prefetch" href="/hdata-doc/assets/js/25.cc923a02.js"><link rel="prefetch" href="/hdata-doc/assets/js/26.432e9cf4.js"><link rel="prefetch" href="/hdata-doc/assets/js/27.3248ab2a.js"><link rel="prefetch" href="/hdata-doc/assets/js/28.67efb541.js"><link rel="prefetch" href="/hdata-doc/assets/js/29.e500a45f.js"><link rel="prefetch" href="/hdata-doc/assets/js/3.5c0f818a.js"><link rel="prefetch" href="/hdata-doc/assets/js/30.27916467.js"><link rel="prefetch" href="/hdata-doc/assets/js/31.db03022b.js"><link rel="prefetch" href="/hdata-doc/assets/js/32.40451343.js"><link rel="prefetch" href="/hdata-doc/assets/js/33.57a8afa5.js"><link rel="prefetch" href="/hdata-doc/assets/js/34.e8da6dc5.js"><link rel="prefetch" href="/hdata-doc/assets/js/35.25dea1e4.js"><link rel="prefetch" href="/hdata-doc/assets/js/36.ecc28683.js"><link rel="prefetch" href="/hdata-doc/assets/js/37.976e826a.js"><link rel="prefetch" href="/hdata-doc/assets/js/38.f1f7e891.js"><link rel="prefetch" href="/hdata-doc/assets/js/39.6daaca2d.js"><link rel="prefetch" href="/hdata-doc/assets/js/4.528973e8.js"><link rel="prefetch" href="/hdata-doc/assets/js/40.3766a207.js"><link rel="prefetch" href="/hdata-doc/assets/js/41.515be286.js"><link rel="prefetch" href="/hdata-doc/assets/js/42.87e45d55.js"><link rel="prefetch" href="/hdata-doc/assets/js/43.0eea2c15.js"><link rel="prefetch" href="/hdata-doc/assets/js/44.f5a1989e.js"><link rel="prefetch" href="/hdata-doc/assets/js/45.96eaa743.js"><link rel="prefetch" href="/hdata-doc/assets/js/46.6db88dae.js"><link rel="prefetch" href="/hdata-doc/assets/js/47.f3e98870.js"><link rel="prefetch" href="/hdata-doc/assets/js/48.138b9428.js"><link rel="prefetch" href="/hdata-doc/assets/js/49.b4e2bdb7.js"><link rel="prefetch" href="/hdata-doc/assets/js/5.53dd3ef1.js"><link rel="prefetch" href="/hdata-doc/assets/js/50.6624a71f.js"><link rel="prefetch" href="/hdata-doc/assets/js/51.4273468b.js"><link rel="prefetch" href="/hdata-doc/assets/js/52.d69c448e.js"><link rel="prefetch" href="/hdata-doc/assets/js/53.3e61789b.js"><link rel="prefetch" href="/hdata-doc/assets/js/55.a2edf6d0.js"><link rel="prefetch" href="/hdata-doc/assets/js/56.324986ae.js"><link rel="prefetch" href="/hdata-doc/assets/js/57.640caf90.js"><link rel="prefetch" href="/hdata-doc/assets/js/58.344d4730.js"><link rel="prefetch" href="/hdata-doc/assets/js/59.d9078674.js"><link rel="prefetch" href="/hdata-doc/assets/js/6.22885e2c.js"><link rel="prefetch" href="/hdata-doc/assets/js/60.2afcb1b9.js"><link rel="prefetch" href="/hdata-doc/assets/js/61.996c28ca.js"><link rel="prefetch" href="/hdata-doc/assets/js/62.cb5e8bee.js"><link rel="prefetch" href="/hdata-doc/assets/js/63.146ed62c.js"><link rel="prefetch" href="/hdata-doc/assets/js/64.8bb9c50a.js"><link rel="prefetch" href="/hdata-doc/assets/js/65.460effd7.js"><link rel="prefetch" href="/hdata-doc/assets/js/66.f5294e94.js"><link rel="prefetch" href="/hdata-doc/assets/js/67.0da1dddd.js"><link rel="prefetch" href="/hdata-doc/assets/js/68.64117a5a.js"><link rel="prefetch" href="/hdata-doc/assets/js/69.ed33359f.js"><link rel="prefetch" href="/hdata-doc/assets/js/7.814d9e01.js"><link rel="prefetch" href="/hdata-doc/assets/js/70.1250ab19.js"><link rel="prefetch" href="/hdata-doc/assets/js/71.f6a79a2a.js"><link rel="prefetch" href="/hdata-doc/assets/js/72.683057b4.js"><link rel="prefetch" href="/hdata-doc/assets/js/73.94e5450b.js"><link rel="prefetch" href="/hdata-doc/assets/js/74.fa587d94.js"><link rel="prefetch" href="/hdata-doc/assets/js/75.48871ae9.js"><link rel="prefetch" href="/hdata-doc/assets/js/76.447894b5.js"><link rel="prefetch" href="/hdata-doc/assets/js/77.da5dadf2.js"><link rel="prefetch" href="/hdata-doc/assets/js/78.a8553a08.js"><link rel="prefetch" href="/hdata-doc/assets/js/79.bd712952.js"><link rel="prefetch" href="/hdata-doc/assets/js/8.a242d330.js"><link rel="prefetch" href="/hdata-doc/assets/js/9.c7938acd.js">
    <link rel="stylesheet" href="/hdata-doc/assets/css/0.styles.ce16c74b.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/hdata-doc/" class="home-link router-link-active"><img src="https://i.postimg.cc/2yr3430s/panda.jpg" alt="唐宋元明清" class="logo"> <span class="site-name can-hide">唐宋元明清</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/hdata-doc/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/hdata-doc/pages/de9b5e/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/768c32/" class="nav-link">Java基础</a></li></ul></li><li class="dropdown-item"><h4>工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/1d1863/" class="nav-link">hutool</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/1d1864/" class="nav-link">commons</a></li></ul></li><li class="dropdown-item"><h4>框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/1e9420/" class="nav-link">Spring Boot相关</a></li></ul></li><li class="dropdown-item"><h4>设计模式</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/bdceb5/" class="nav-link">设计模式入门</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><!----> <span class="title" style="display:;">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Hadoop</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/5d76a5/" class="nav-link">Hadoop分布式搭建</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/f9f70f/" class="nav-link">Hadoop高可用搭建</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/3e77b2/" class="nav-link">集群端口</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/03a2bd/" class="nav-link">代码demo</a></li></ul></li><li class="dropdown-item"><h4>Zookeeper</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/e2226d/" class="nav-link">Zookeeper集群搭建</a></li></ul></li><li class="dropdown-item"><h4>Hive</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/edf4cb/" class="nav-link">Hive集群搭建</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/dd806a/" class="nav-link">Hive相关</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/dd807a/" class="nav-link">HSQL</a></li></ul></li><li class="dropdown-item"><h4>Kafka</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/bfa383/" class="nav-link">Kafka集群搭建</a></li></ul></li><li class="dropdown-item"><h4>HBase</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/b22228/" class="nav-link">HBase集群搭建</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/e15afa/" class="nav-link">HBase基础学习</a></li></ul></li><li class="dropdown-item"><h4>Spark</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/7d157d/" class="nav-link">Spark环境搭建</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/b3ba00/" class="nav-link">Spark相关知识</a></li></ul></li><li class="dropdown-item"><h4>Flink</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/415096/" class="nav-link">Flink环境搭建</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/415097/" class="nav-link">Flink学习</a></li></ul></li><li class="dropdown-item"><h4>Flume</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/e4166e/" class="nav-link">Flume安装配置</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/0376ec/" class="nav-link">Flume高可用集群安装</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/3408a8/" class="nav-link">Flume相关学习</a></li></ul></li><li class="dropdown-item"><h4>Sqoop</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/60b3d7/" class="nav-link">Sqoop安装配置</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/40f7a3/" class="nav-link">Sqoop使用</a></li></ul></li><li class="dropdown-item"><h4>其他</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/d89b45/" class="nav-link">docker</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/hdata-doc/pages/e0cc49/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Oracle</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/7e6951/" aria-current="page" class="nav-link router-link-exact-active router-link-active">Oracle相关知识杂记</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/b5c27a/" class="nav-link">系统函数篇</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/c2df29/" class="nav-link">与MySQL语法区别</a></li></ul></li><li class="dropdown-item"><h4>MySQL</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/36476d/" class="nav-link">MySQL知识点</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><!----> <span class="title" style="display:;">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Python</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/f2a330/" class="nav-link">Python简单语法</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/f2a340/" class="nav-link">Python操作Office</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/f2a341/" class="nav-link">Python类库学习</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/f799c7/" class="nav-link">Python爬虫</a></li></ul></li><li class="dropdown-item"><h4>Shell</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/5704cc/" class="nav-link">Shell基础</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/5765cc/" class="nav-link">Shell命令行</a></li></ul></li><li class="dropdown-item"><h4>Scala</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/c917bd/" class="nav-link">语法学习</a></li></ul></li><li class="dropdown-item"><h4>正则表达式</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/e4e158/" class="nav-link">正则基础</a></li></ul></li><li class="dropdown-item"><h4>调度</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/a04438/" class="nav-link">调度工具</a></li></ul></li><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/gxfmrs/" class="nav-link">前端相关</a></li></ul></li><li class="dropdown-item"><h4>杂记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/414e9c/" class="nav-link">常用工具或网站</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/c0e729/" class="nav-link">琐碎知识</a></li></ul></li><li class="dropdown-item"><h4>摘录</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/AXI4oJ/" class="nav-link">摘录</a></li></ul></li></ul></div></div> <a href="https://github.com/user-h/hdata-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/hdata-doc/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/hdata-doc/pages/de9b5e/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/768c32/" class="nav-link">Java基础</a></li></ul></li><li class="dropdown-item"><h4>工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/1d1863/" class="nav-link">hutool</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/1d1864/" class="nav-link">commons</a></li></ul></li><li class="dropdown-item"><h4>框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/1e9420/" class="nav-link">Spring Boot相关</a></li></ul></li><li class="dropdown-item"><h4>设计模式</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/bdceb5/" class="nav-link">设计模式入门</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><!----> <span class="title" style="display:;">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Hadoop</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/5d76a5/" class="nav-link">Hadoop分布式搭建</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/f9f70f/" class="nav-link">Hadoop高可用搭建</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/3e77b2/" class="nav-link">集群端口</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/03a2bd/" class="nav-link">代码demo</a></li></ul></li><li class="dropdown-item"><h4>Zookeeper</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/e2226d/" class="nav-link">Zookeeper集群搭建</a></li></ul></li><li class="dropdown-item"><h4>Hive</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/edf4cb/" class="nav-link">Hive集群搭建</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/dd806a/" class="nav-link">Hive相关</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/dd807a/" class="nav-link">HSQL</a></li></ul></li><li class="dropdown-item"><h4>Kafka</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/bfa383/" class="nav-link">Kafka集群搭建</a></li></ul></li><li class="dropdown-item"><h4>HBase</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/b22228/" class="nav-link">HBase集群搭建</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/e15afa/" class="nav-link">HBase基础学习</a></li></ul></li><li class="dropdown-item"><h4>Spark</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/7d157d/" class="nav-link">Spark环境搭建</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/b3ba00/" class="nav-link">Spark相关知识</a></li></ul></li><li class="dropdown-item"><h4>Flink</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/415096/" class="nav-link">Flink环境搭建</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/415097/" class="nav-link">Flink学习</a></li></ul></li><li class="dropdown-item"><h4>Flume</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/e4166e/" class="nav-link">Flume安装配置</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/0376ec/" class="nav-link">Flume高可用集群安装</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/3408a8/" class="nav-link">Flume相关学习</a></li></ul></li><li class="dropdown-item"><h4>Sqoop</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/60b3d7/" class="nav-link">Sqoop安装配置</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/40f7a3/" class="nav-link">Sqoop使用</a></li></ul></li><li class="dropdown-item"><h4>其他</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/d89b45/" class="nav-link">docker</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/hdata-doc/pages/e0cc49/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Oracle</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/7e6951/" aria-current="page" class="nav-link router-link-exact-active router-link-active">Oracle相关知识杂记</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/b5c27a/" class="nav-link">系统函数篇</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/c2df29/" class="nav-link">与MySQL语法区别</a></li></ul></li><li class="dropdown-item"><h4>MySQL</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/36476d/" class="nav-link">MySQL知识点</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><!----> <span class="title" style="display:;">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Python</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/f2a330/" class="nav-link">Python简单语法</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/f2a340/" class="nav-link">Python操作Office</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/f2a341/" class="nav-link">Python类库学习</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/f799c7/" class="nav-link">Python爬虫</a></li></ul></li><li class="dropdown-item"><h4>Shell</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/5704cc/" class="nav-link">Shell基础</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/5765cc/" class="nav-link">Shell命令行</a></li></ul></li><li class="dropdown-item"><h4>Scala</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/c917bd/" class="nav-link">语法学习</a></li></ul></li><li class="dropdown-item"><h4>正则表达式</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/e4e158/" class="nav-link">正则基础</a></li></ul></li><li class="dropdown-item"><h4>调度</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/a04438/" class="nav-link">调度工具</a></li></ul></li><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/gxfmrs/" class="nav-link">前端相关</a></li></ul></li><li class="dropdown-item"><h4>杂记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/414e9c/" class="nav-link">常用工具或网站</a></li><li class="dropdown-subitem"><a href="/hdata-doc/pages/c0e729/" class="nav-link">琐碎知识</a></li></ul></li><li class="dropdown-item"><h4>摘录</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/hdata-doc/pages/AXI4oJ/" class="nav-link">摘录</a></li></ul></li></ul></div></div> <a href="https://github.com/user-h/hdata-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Oracle</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hdata-doc/pages/7e6951/" aria-current="page" class="active sidebar-link">Oracle相关知识杂记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/hdata-doc/pages/7e6951/#oracle-常用性能排查语句" class="sidebar-link">Oracle 常用性能排查语句</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#查看表空间大小" class="sidebar-link">查看表空间大小</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#查看锁表及解决" class="sidebar-link">查看锁表及解决</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#查询行锁并解决" class="sidebar-link">查询行锁并解决</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#刷新表统计信息-做表分析" class="sidebar-link">刷新表统计信息（做表分析）</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#查询正在执行的sql" class="sidebar-link">查询正在执行的SQL</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#查询sql平均耗时" class="sidebar-link">查询SQL平均耗时</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#慢查询耗时" class="sidebar-link">慢查询耗时</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#找到正在运行的存储过程并杀死" class="sidebar-link">找到正在运行的存储过程并杀死</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#其他" class="sidebar-link">其他</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/hdata-doc/pages/7e6951/#scn" class="sidebar-link">SCN</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/hdata-doc/pages/7e6951/#oracle-表闪回" class="sidebar-link">Oracle 表闪回</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#查询历史版本数据-闪回查询" class="sidebar-link">查询历史版本数据（闪回查询）</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#恢复已删除的表" class="sidebar-link">恢复已删除的表</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#恢复表到某个时间点" class="sidebar-link">恢复表到某个时间点</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/hdata-doc/pages/7e6951/#logminer" class="sidebar-link">LogMiner</a></li><li class="sidebar-sub-header level2"><a href="/hdata-doc/pages/7e6951/#动态性能视图-x-v-gv-v-gv" class="sidebar-link">动态性能视图(x$,v$,gv$,v$,gv$)</a></li><li class="sidebar-sub-header level2"><a href="/hdata-doc/pages/7e6951/#常用系统表" class="sidebar-link">常用系统表</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/hdata-doc/pages/7e6951/#实例" class="sidebar-link">实例</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#查看视图中用到的表和视图" class="sidebar-link">查看视图中用到的表和视图</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#用到-某个表-的视图" class="sidebar-link">用到 某个表 的视图</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#查看视图或表创建语句" class="sidebar-link">查看视图或表创建语句</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#查询建表语句-不含注释" class="sidebar-link">查询建表语句（不含注释）</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#查看函数、存储过程、触发器、包等创建语句" class="sidebar-link">查看函数、存储过程、触发器、包等创建语句</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#迁移数据-大批量操作数据-前禁用索引" class="sidebar-link">迁移数据（大批量操作数据）前禁用索引！！！</a></li><li class="sidebar-sub-header level4"><a href="/hdata-doc/pages/7e6951/#查询数据表自上次统计信息收集以来数据变化量" class="sidebar-link">查询数据表自上次统计信息收集以来数据变化量</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/hdata-doc/pages/7e6951/#与mysql区别" class="sidebar-link">与MySQL区别</a></li><li class="sidebar-sub-header level2"><a href="/hdata-doc/pages/7e6951/#shell跑oracle脚本" class="sidebar-link">Shell跑oracle脚本</a></li><li class="sidebar-sub-header level2"><a href="/hdata-doc/pages/7e6951/#oracle关联方式-执行计划" class="sidebar-link">Oracle关联方式（执行计划）</a></li><li class="sidebar-sub-header level2"><a href="/hdata-doc/pages/7e6951/#点状知识" class="sidebar-link">点状知识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/hdata-doc/pages/7e6951/#匹配中文" class="sidebar-link">匹配中文</a></li><li class="sidebar-sub-header level3"><a href="/hdata-doc/pages/7e6951/#创建dblink" class="sidebar-link">创建DBLink</a></li><li class="sidebar-sub-header level3"><a href="/hdata-doc/pages/7e6951/#sql并行" class="sidebar-link">SQL并行</a></li><li class="sidebar-sub-header level3"><a href="/hdata-doc/pages/7e6951/#中文排序方式" class="sidebar-link">中文排序方式</a></li><li class="sidebar-sub-header level3"><a href="/hdata-doc/pages/7e6951/#数据中包含特殊符号需要转义" class="sidebar-link">数据中包含特殊符号需要转义</a></li><li class="sidebar-sub-header level3"><a href="/hdata-doc/pages/7e6951/#数据泵导入导出-待完善" class="sidebar-link">数据泵导入导出（待完善）</a></li><li class="sidebar-sub-header level3"><a href="/hdata-doc/pages/7e6951/#oracle-高版本导出-低版本导入-修改版本号" class="sidebar-link">Oracle 高版本导出，低版本导入，修改版本号</a></li><li class="sidebar-sub-header level3"><a href="/hdata-doc/pages/7e6951/#redolog-导库、大批量、长事务是不是需要调整" class="sidebar-link">REDOLOG（导库、大批量、长事务是不是需要调整？）</a></li><li class="sidebar-sub-header level3"><a href="/hdata-doc/pages/7e6951/#解决本地oracle服务内存占用过高" class="sidebar-link">解决本地Oracle服务内存占用过高</a></li><li class="sidebar-sub-header level3"><a href="/hdata-doc/pages/7e6951/#数据插入慢的问题" class="sidebar-link">数据插入慢的问题</a></li></ul></li></ul></li><li><a href="/hdata-doc/pages/b5c27a/" class="sidebar-link">系统函数篇</a></li><li><a href="/hdata-doc/pages/c2df29/" class="sidebar-link">与MySQL语法区别</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>MySQL</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hdata-doc/pages/36476d/" class="sidebar-link">MySQL琐碎知识点</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>国产数据库</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hdata-doc/pages/086761/" class="sidebar-link">达梦数据库</a></li><li><a href="/hdata-doc/pages/e461e3/" class="sidebar-link">华为高斯数据库</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Redis</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hdata-doc/pages/ca5c12/" class="sidebar-link">Redis命令学习</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Excel</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hdata-doc/pages/265b1a/" class="sidebar-link">Excel技巧</a></li></ul></section></li><li><a href="/hdata-doc/pages/e0cc49/" class="sidebar-link">数据库</a></li><li><a href="/hdata-doc/pages/e02b49/" class="sidebar-link">SQL非常规用法</a></li><li><a href="/hdata-doc/pages/d5b8e9/" class="sidebar-link">SQL练习题</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/hdata-doc/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>数据库</span></li><li data-v-06225672><span data-v-06225672>Oracle</span></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/user-h" target="_blank" title="作者" class="beLink" data-v-06225672>Ai</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-02-23</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Oracle相关知识杂记<!----></h1>  <div class="theme-vdoing-content content__default"><h2 id="oracle-常用性能排查语句"><a href="#oracle-常用性能排查语句" class="header-anchor">#</a> Oracle 常用性能排查语句</h2> <h4 id="查看表空间大小"><a href="#查看表空间大小" class="header-anchor">#</a> 查看表空间大小</h4> <hr> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">--oracle表空间大小</span>
<span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>tablespace_name <span class="token string">&quot;表空间名&quot;</span><span class="token punctuation">,</span>
       total <span class="token string">&quot;表空间大小&quot;</span><span class="token punctuation">,</span>
       free <span class="token string">&quot;表空间剩余大小&quot;</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span>total <span class="token operator">-</span> free<span class="token punctuation">)</span> <span class="token string">&quot;表空间使用大小&quot;</span><span class="token punctuation">,</span>
       <span class="token function">round</span><span class="token punctuation">(</span>total <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;表空间大小(G)&quot;</span><span class="token punctuation">,</span>
       <span class="token function">round</span><span class="token punctuation">(</span>free <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;表空间剩余大小(G)&quot;</span><span class="token punctuation">,</span>
       <span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>total <span class="token operator">-</span> free<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;表空间使用大小(G)&quot;</span><span class="token punctuation">,</span>
       <span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>total <span class="token operator">-</span> free<span class="token punctuation">)</span> <span class="token operator">/</span> total<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token string">&quot;使用率 %&quot;</span>
  <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> tablespace_name<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span> free
          <span class="token keyword">FROM</span> dba_free_space
         <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> tablespace_name<span class="token punctuation">)</span> a<span class="token punctuation">,</span>
       <span class="token punctuation">(</span><span class="token keyword">SELECT</span> tablespace_name<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span> total
          <span class="token keyword">FROM</span> dba_data_files
         <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> tablespace_name<span class="token punctuation">)</span> b
 <span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>tablespace_name <span class="token operator">=</span> b<span class="token punctuation">.</span>tablespace_name
</code></pre></div><p><strong>查看单表占用磁盘空间</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
  <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> T<span class="token punctuation">.</span>TABLESPACE_NAME<span class="token punctuation">,</span>
               T<span class="token punctuation">.</span>OWNER<span class="token punctuation">,</span>
               T<span class="token punctuation">.</span>SEGMENT_NAME<span class="token punctuation">,</span>
               T<span class="token punctuation">.</span>SEGMENT_TYPE<span class="token punctuation">,</span>
               <span class="token function">SUM</span><span class="token punctuation">(</span>T<span class="token punctuation">.</span>BYTES <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span> MB
          <span class="token keyword">FROM</span> DBA_SEGMENTS T
         <span class="token keyword">WHERE</span> T<span class="token punctuation">.</span>SEGMENT_TYPE <span class="token operator">=</span> <span class="token string">'TABLE'</span> <span class="token operator">AND</span> T<span class="token punctuation">.</span>SEGMENT_NAME <span class="token operator">=</span> <span class="token string">'TABLE_NAME'</span>
         <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> T<span class="token punctuation">.</span>TABLESPACE_NAME<span class="token punctuation">,</span> T<span class="token punctuation">.</span>OWNER<span class="token punctuation">,</span> T<span class="token punctuation">.</span>SEGMENT_NAME<span class="token punctuation">,</span> T<span class="token punctuation">.</span>SEGMENT_TYPE<span class="token punctuation">)</span> T
 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> T<span class="token punctuation">.</span>MB <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="查看锁表及解决"><a href="#查看锁表及解决" class="header-anchor">#</a> 查看锁表及解决</h4> <hr> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token number">1.</span>下面的语句用来查询哪些对象被锁：
<span class="token keyword">select</span> object_name<span class="token punctuation">,</span>machine<span class="token punctuation">,</span>s<span class="token punctuation">.</span>sid<span class="token punctuation">,</span>s<span class="token punctuation">.</span><span class="token keyword">serial</span><span class="token comment">#,l.ORACLE_USERNAME</span>
<span class="token keyword">from</span> v$locked_object l<span class="token punctuation">,</span>dba_objects o <span class="token punctuation">,</span>v$<span class="token keyword">session</span> s
<span class="token keyword">where</span> l<span class="token punctuation">.</span>object_id　<span class="token operator">=</span>　o<span class="token punctuation">.</span>object_id <span class="token operator">and</span> l<span class="token punctuation">.</span>session_id<span class="token operator">=</span>s<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
<span class="token number">2.</span>下面的语句用来杀死一个进程：
<span class="token keyword">alter</span> system <span class="token keyword">kill</span> <span class="token keyword">session</span> <span class="token string">'24,111'</span><span class="token punctuation">;</span> <span class="token punctuation">(</span>其中<span class="token number">24</span><span class="token punctuation">,</span><span class="token number">111</span>分别是上面查询出的sid<span class="token punctuation">,</span><span class="token keyword">serial</span><span class="token comment">#);</span>
<span class="token number">3.</span>批量删除
<span class="token keyword">select</span> <span class="token string">'alter system kill session '''</span> <span class="token operator">||</span> s<span class="token punctuation">.</span>sid <span class="token operator">||</span> <span class="token string">','</span> <span class="token operator">||</span> s<span class="token punctuation">.</span><span class="token keyword">serial</span><span class="token comment"># || '''' || ';'</span>
  <span class="token keyword">from</span> v$locked_object l<span class="token punctuation">,</span> dba_objects o<span class="token punctuation">,</span> v$<span class="token keyword">session</span> s
 <span class="token keyword">where</span> l<span class="token punctuation">.</span>object_id　 <span class="token operator">=</span> 　o<span class="token punctuation">.</span>object_id
   <span class="token operator">and</span> l<span class="token punctuation">.</span>session_id <span class="token operator">=</span> s<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>

<span class="token keyword">select</span> object_name<span class="token punctuation">,</span>a<span class="token punctuation">.</span>SQL_TEXT<span class="token punctuation">,</span>machine<span class="token punctuation">,</span>s<span class="token punctuation">.</span>sid<span class="token punctuation">,</span>s<span class="token punctuation">.</span><span class="token keyword">serial</span><span class="token comment">#,s.status,lockwait,machine,program</span>
<span class="token keyword">from</span> v$locked_object l<span class="token punctuation">,</span>dba_objects o <span class="token punctuation">,</span>v$<span class="token keyword">session</span> s<span class="token punctuation">,</span>v$<span class="token keyword">sql</span> a
<span class="token keyword">where</span> l<span class="token punctuation">.</span>object_id　<span class="token operator">=</span>　o<span class="token punctuation">.</span>object_id <span class="token operator">and</span> l<span class="token punctuation">.</span>session_id<span class="token operator">=</span>s<span class="token punctuation">.</span>sid <span class="token operator">and</span> a<span class="token punctuation">.</span>HASH_VALUE <span class="token operator">=</span> s<span class="token punctuation">.</span>SQL_HASH_VALUE<span class="token punctuation">;</span>
Username：死锁语句所用的数据库用户；
Lockwait：死锁的状态，如果有内容表示被死锁。
<span class="token keyword">Status</span>： 状态，active表示被死锁
Machine： 死锁语句所在的机器。
Program： 产生死锁的语句主要来自哪个应用程序。



   <span class="token keyword">select</span> b<span class="token punctuation">.</span>file_id　　文件ID<span class="token punctuation">,</span>
　　      b<span class="token punctuation">.</span>tablespace_name　　表空间<span class="token punctuation">,</span>
　　      b<span class="token punctuation">.</span>file_name　　　　　物理文件名<span class="token punctuation">,</span>
　　      b<span class="token punctuation">.</span>bytes　　　　　　　总字节数<span class="token punctuation">,</span>
　　      <span class="token punctuation">(</span>b<span class="token punctuation">.</span>bytes<span class="token operator">-</span><span class="token function">sum</span><span class="token punctuation">(</span>nvl<span class="token punctuation">(</span>a<span class="token punctuation">.</span>bytes<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>　　　已使用<span class="token punctuation">,</span>
　　      <span class="token function">sum</span><span class="token punctuation">(</span>nvl<span class="token punctuation">(</span>a<span class="token punctuation">.</span>bytes<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>　　　　　　　　剩余<span class="token punctuation">,</span>
　　      <span class="token function">sum</span><span class="token punctuation">(</span>nvl<span class="token punctuation">(</span>a<span class="token punctuation">.</span>bytes<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>bytes<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span>　剩余百分比
　　 <span class="token keyword">from</span> dba_free_space a<span class="token punctuation">,</span>dba_data_files b
　　<span class="token keyword">where</span> a<span class="token punctuation">.</span>file_id<span class="token operator">=</span>b<span class="token punctuation">.</span>file_id
 <span class="token keyword">group</span> <span class="token keyword">by</span> b<span class="token punctuation">.</span>tablespace_name<span class="token punctuation">,</span>b<span class="token punctuation">.</span>file_name<span class="token punctuation">,</span>b<span class="token punctuation">.</span>file_id<span class="token punctuation">,</span>b<span class="token punctuation">.</span>bytes
 <span class="token keyword">order</span> <span class="token keyword">by</span> b<span class="token punctuation">.</span>tablespace_name



<span class="token comment">--最新</span>
<span class="token keyword">select</span> object_name<span class="token punctuation">,</span>a<span class="token punctuation">.</span>SQL_TEXT<span class="token punctuation">,</span>machine<span class="token punctuation">,</span>s<span class="token punctuation">.</span>sid<span class="token punctuation">,</span>s<span class="token punctuation">.</span><span class="token keyword">serial</span><span class="token comment">#,s.status,lockwait,machine,program,l.ORACLE_USERNAME</span>
  <span class="token keyword">from</span> v$locked_object l<span class="token punctuation">,</span>dba_objects o <span class="token punctuation">,</span>v$<span class="token keyword">session</span> s<span class="token punctuation">,</span>v$<span class="token keyword">sql</span> a
 <span class="token keyword">where</span> l<span class="token punctuation">.</span>object_id　<span class="token operator">=</span>　o<span class="token punctuation">.</span>object_id <span class="token operator">and</span> l<span class="token punctuation">.</span>session_id<span class="token operator">=</span>s<span class="token punctuation">.</span>sid <span class="token operator">and</span> a<span class="token punctuation">.</span>HASH_VALUE <span class="token operator">=</span> s<span class="token punctuation">.</span>SQL_HASH_VALUE<span class="token punctuation">;</span>

<span class="token keyword">alter</span> system <span class="token keyword">kill</span> <span class="token keyword">session</span> <span class="token string">'1902,24317'</span><span class="token punctuation">;</span> 


<span class="token keyword">grant</span> <span class="token keyword">alter</span> system <span class="token keyword">to</span> ysgl_guanli
</code></pre></div><h4 id="查询行锁并解决"><a href="#查询行锁并解决" class="header-anchor">#</a> 查询行锁并解决</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">--------------------------------- 方案1</span>
<span class="token comment">--行锁查看</span>
<span class="token keyword">select</span> s<span class="token punctuation">.</span>SID<span class="token punctuation">,</span>s<span class="token punctuation">.</span><span class="token keyword">SERIAL</span><span class="token comment">#,s.MACHINE,s.TYPE,l.TYPE,l.CTIME,l.BLOCK,l.REQUEST,l.LMODE,</span>
       decode<span class="token punctuation">(</span>l<span class="token punctuation">.</span>lmode<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'None'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'Null'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'Row-S (SS)'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Row-X (SX)'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'Share'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'S/Row-X (SSX)'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'Exclusive'</span><span class="token punctuation">,</span> substr<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>l<span class="token punctuation">.</span>lmode<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token string">&quot;Locked Mode&quot;</span><span class="token punctuation">,</span>
       DECODE<span class="token punctuation">(</span>L<span class="token punctuation">.</span><span class="token keyword">TYPE</span><span class="token punctuation">,</span><span class="token string">'MR'</span><span class="token punctuation">,</span><span class="token string">'File_ID:'</span> <span class="token operator">||</span> L<span class="token punctuation">.</span>ID1<span class="token punctuation">,</span><span class="token string">'TM'</span><span class="token punctuation">,</span>t<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span><span class="token string">'TX'</span><span class="token punctuation">,</span><span class="token string">'USN:'</span> <span class="token operator">||</span> to_char<span class="token punctuation">(</span>TRUNC<span class="token punctuation">(</span>L<span class="token punctuation">.</span>ID1 <span class="token operator">/</span> <span class="token number">65536</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">'RWO:'</span> <span class="token operator">||</span>nvl<span class="token punctuation">(</span>r<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span> <span class="token string">'None'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> L<span class="token punctuation">.</span>ID1<span class="token punctuation">)</span> <span class="token keyword">as</span> LOCK_ID1<span class="token punctuation">,</span>
       <span class="token string">'alter system kill session '''</span> <span class="token operator">||</span> s<span class="token punctuation">.</span>SID <span class="token operator">||</span> <span class="token string">','</span> <span class="token operator">||</span> s<span class="token punctuation">.</span><span class="token keyword">SERIAL</span><span class="token comment"># || '''immediate;' as &quot;Kill&quot;</span>
  <span class="token keyword">from</span> gv$process p
 <span class="token keyword">inner</span> <span class="token keyword">join</span> gv$<span class="token keyword">session</span> s
    <span class="token keyword">on</span> s<span class="token punctuation">.</span>PADDR <span class="token operator">=</span> p<span class="token punctuation">.</span>ADDR
 <span class="token keyword">inner</span> <span class="token keyword">join</span> v$<span class="token keyword">lock</span> l
    <span class="token keyword">on</span> l<span class="token punctuation">.</span>SID <span class="token operator">=</span> s<span class="token punctuation">.</span>SID
  <span class="token keyword">left</span> <span class="token keyword">join</span> sys<span class="token punctuation">.</span>obj$ t
    <span class="token keyword">on</span> l<span class="token punctuation">.</span>ID1 <span class="token operator">=</span> t<span class="token punctuation">.</span>obj<span class="token comment">#</span>
  <span class="token keyword">left</span> <span class="token keyword">join</span> sys<span class="token punctuation">.</span>obj$ r
    <span class="token keyword">on</span> s<span class="token punctuation">.</span>ROW_WAIT_OBJ<span class="token comment"># = r.obj#</span>
 <span class="token keyword">where</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">1</span>
   <span class="token operator">and</span> l<span class="token punctuation">.</span><span class="token keyword">TYPE</span> <span class="token operator">!=</span> <span class="token string">'MR'</span> 
 <span class="token operator">and</span> l<span class="token punctuation">.</span><span class="token keyword">TYPE</span>  <span class="token operator">=</span> <span class="token string">'TM'</span>
   <span class="token operator">and</span> l<span class="token punctuation">.</span>lmode <span class="token operator">=</span> <span class="token number">3</span>
 <span class="token keyword">order</span> <span class="token keyword">by</span> s<span class="token punctuation">.</span>SID<span class="token punctuation">;</span>

<span class="token comment">-- 查看原因?</span>
<span class="token keyword">WITH</span> sessions <span class="token keyword">AS</span>
<span class="token punctuation">(</span><span class="token keyword">SELECT</span>  <span class="token comment">/*+materialize*/</span>
         sid
        <span class="token punctuation">,</span>sql_id
        <span class="token punctuation">,</span>event
        <span class="token punctuation">,</span>blocking_session
        <span class="token punctuation">,</span>row_wait_obj<span class="token comment">#</span>
<span class="token keyword">FROM</span> gv$<span class="token keyword">session</span><span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> LPAD<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token keyword">LEVEL</span> <span class="token punctuation">)</span> <span class="token operator">||</span> sid sid
      <span class="token punctuation">,</span>sql_id
      <span class="token punctuation">,</span>event
      <span class="token punctuation">,</span>owner<span class="token operator">||</span>decode<span class="token punctuation">(</span>owner<span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token boolean">null</span><span class="token punctuation">,</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token operator">||</span>object_name object_name
      <span class="token punctuation">,</span>substr<span class="token punctuation">(</span>sql_text<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">)</span> sql_text
<span class="token keyword">FROM</span> sessions s
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> dba_objects <span class="token keyword">ON</span> <span class="token punctuation">(</span>object_id <span class="token operator">=</span> row_wait_obj<span class="token comment">#)</span>
<span class="token keyword">LEFT</span> <span class="token keyword">OUTER</span> <span class="token keyword">JOIN</span> v$<span class="token keyword">sql</span> <span class="token keyword">USING</span> <span class="token punctuation">(</span>sql_id<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> sid <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> blocking_session <span class="token keyword">FROM</span> sessions<span class="token punctuation">)</span>
<span class="token operator">OR</span> blocking_session <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token keyword">CONNECT</span> <span class="token keyword">BY</span> PRIOR sid <span class="token operator">=</span> blocking_session
   <span class="token keyword">START</span> <span class="token keyword">WITH</span> blocking_session <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token comment">--------------------------------- 方案2</span>
   <span class="token keyword">select</span> <span class="token string">'alter system kill session '''</span> <span class="token operator">||</span> ss<span class="token punctuation">.</span>sid <span class="token operator">||</span> <span class="token string">''</span> <span class="token operator">||</span> <span class="token string">','</span> <span class="token operator">||</span> ss<span class="token punctuation">.</span><span class="token keyword">serial</span><span class="token comment"># || ',@' ||</span>
       ss<span class="token punctuation">.</span>inst_id <span class="token operator">||</span> <span class="token string">''' immediate;'</span> db_kill_session
  <span class="token keyword">from</span> gv$<span class="token keyword">session</span> s<span class="token punctuation">,</span> 
  gv$<span class="token keyword">session</span> ss
 <span class="token keyword">where</span> s<span class="token punctuation">.</span>final_blocking_session <span class="token operator">is</span> <span class="token operator">not</span> <span class="token boolean">null</span>
   <span class="token operator">and</span> s<span class="token punctuation">.</span>final_blocking_instance <span class="token operator">=</span> ss<span class="token punctuation">.</span>inst_id
   <span class="token operator">and</span> s<span class="token punctuation">.</span>final_blocking_session <span class="token operator">=</span> ss<span class="token punctuation">.</span>sid
   <span class="token operator">and</span> s<span class="token punctuation">.</span>sid <span class="token operator">&lt;&gt;</span> ss<span class="token punctuation">.</span>sid<span class="token punctuation">;</span>
</code></pre></div><h4 id="刷新表统计信息-做表分析"><a href="#刷新表统计信息-做表分析" class="header-anchor">#</a> 刷新表统计信息（做表分析）</h4> <p>  统计信息主要是描述数据库中表，索引的大小，规模，数据分布状况等的一类信息。例如，表的行数，块数，平均每行的大小，索引的leaf blocks，索引字段的行数，不同值的大小等，都属于统计信息。CBO正是根据这些统计信息数据，计算出不同访问路径下，不同join 方式下，各种计划的成本，最后选择出成本最小的计划。</p> <p>  统计信息是存放在数据字典表中的，如tab$，一般可通过察看某些视图来获取统计信息状况，如DBA_TABLES，DBA_INDEXES，DBA_TAB_COL_STATISTICS， DBA_TAB_HISTOGRAMS等。在这些视图中包含表示统计信息的一些字段，这些字段只有搜集过统计信息之后才有值，否则是空的。例如：last_analyzed 字段表示上次统计信息搜集的时间，可以根据这个字段，快速的了解最近一次统计信息搜集的时间。</p> <p><strong>博客：</strong> <a href="https://www.cnblogs.com/youngerger/p/9050679.html" target="_blank" rel="noopener noreferrer">有关Oracle统计信息的知识点<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <strong>博客：</strong> <a href="https://www.xp.cn/b.php/7376.html" target="_blank" rel="noopener noreferrer">Oracle 11g新特性之统计信息收集<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">--当表没有做分析的时候，Oracle 会使用动态采样来收集统计信息。获取准确的段对象（表，表分区，索引等）的分析数据，是CBO存在的基石，</span>
<span class="token comment">--CBO的机制就是收集尽可能多的对象信息和系统信息，通过对这些信息进行计算，分析，评估，最终得出一个成本最低的执行计划。</span>
<span class="token comment">--所以对于CBO，数据段的分析就非常重要。</span>

解锁单个用户<span class="token keyword">schema</span>
<span class="token keyword">exec</span> dbms_stats<span class="token punctuation">.</span>unlock_schema_stats<span class="token punctuation">(</span><span class="token string">'用户名'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

单个表统计数据的统计数据更新
<span class="token keyword">EXEC</span> dbms_stats<span class="token punctuation">.</span>gather_table_stats<span class="token punctuation">(</span><span class="token string">'【username】'</span><span class="token punctuation">,</span><span class="token string">'【tablename】'</span><span class="token punctuation">,</span> estimate_percent <span class="token operator">=</span><span class="token operator">&gt;</span> dbms_stats<span class="token punctuation">.</span>auto_sample_size<span class="token punctuation">,</span> <span class="token keyword">cascade</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- EXEC dbms_stats.gather_table_stats('【username】','【tablename】',cascade=&gt;true);</span>
<span class="token comment">-- analyze table tablename compute statistics 等同于 analyze table tablename compute statistics for table for all indexes for all columns</span>

<span class="token comment">-- 更新整个用户所有表的统计数据更新</span>
<span class="token comment">-- EXEC dbms_stats.gather_schema_stats('【username】',estimate_percent=&gt;100,cascade=&gt; TRUE);</span>


参数说明: <span class="token punctuation">(</span>https:<span class="token comment">//www.cnblogs.com/tingxin/p/12663682.html)</span>
ownname:要分析表的拥有者
tabname:要分析的表名<span class="token punctuation">.</span>
partname:分区的名字<span class="token punctuation">,</span>只对分区表或分区索引有用<span class="token punctuation">.</span>
estimate_percent:采样行的百分比<span class="token punctuation">,</span>取值范围<span class="token punctuation">[</span><span class="token number">0.000001</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token boolean">null</span>为全部分析<span class="token punctuation">,</span>不采样<span class="token punctuation">.</span> 常量:DBMS_STATS<span class="token punctuation">.</span>AUTO_SAMPLE_SIZE是默认值<span class="token punctuation">,</span>由oracle决定最佳取采样值<span class="token punctuation">.</span>
block_sapmple:是否用块采样代替行采样<span class="token punctuation">.</span>
method_opt:决定histograms信息是怎样被统计的<span class="token punctuation">.</span>method_opt的取值如下<span class="token punctuation">(</span>默认值为<span class="token keyword">FOR</span> <span class="token keyword">ALL</span> <span class="token keyword">COLUMNS</span> SIZE AUTO<span class="token punctuation">)</span>:
<span class="token keyword">for</span> <span class="token keyword">all</span> <span class="token keyword">columns</span>:统计所有列的histograms<span class="token punctuation">.</span>
<span class="token keyword">for</span> <span class="token keyword">all</span> indexed <span class="token keyword">columns</span>:统计所有indexed列的histograms<span class="token punctuation">.</span>
<span class="token keyword">for</span> <span class="token keyword">all</span> hidden <span class="token keyword">columns</span>:统计你看不到列的histograms
<span class="token keyword">for</span> <span class="token keyword">columns</span> <span class="token operator">&lt;</span>list<span class="token operator">&gt;</span> SIZE <span class="token operator">&lt;</span>N<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">REPEAT</span> <span class="token operator">|</span> AUTO <span class="token operator">|</span> SKEWONLY:统计指定列的histograms<span class="token punctuation">.</span>N的取值范围<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">254</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">REPEAT</span>上次统计过的histograms<span class="token punctuation">;</span>AUTO由oracle决定N的大小<span class="token punctuation">;</span>SKEWONLY multiple <span class="token keyword">end</span><span class="token operator">-</span>points <span class="token keyword">with</span> the same <span class="token keyword">value</span> which <span class="token operator">is</span> what we define <span class="token keyword">by</span> &quot;there <span class="token operator">is</span> skew <span class="token operator">in</span> thedata
degree:决定并行度<span class="token punctuation">.</span>默认值为<span class="token boolean">null</span><span class="token punctuation">.</span>
granularity:Granularity <span class="token keyword">of</span> <span class="token keyword">statistics</span> <span class="token keyword">to</span> collect <span class="token punctuation">,</span>only pertinent <span class="token keyword">if</span> the <span class="token keyword">table</span> <span class="token operator">is</span> partitioned<span class="token punctuation">.</span>
<span class="token keyword">cascade</span>:是收集索引的信息<span class="token punctuation">.</span>默认为<span class="token boolean">FALSE</span><span class="token punctuation">.</span>
stattab:指定要存储统计信息的表<span class="token punctuation">,</span>statid如果多个表的统计信息存储在同一个stattab中用于进行区分<span class="token punctuation">.</span>statown存储统计信息表的拥有者<span class="token punctuation">.</span>以上三个参数若不指定<span class="token punctuation">,</span>统计信息会直接更新到数据字典<span class="token punctuation">.</span>
no_invalidate: Does <span class="token operator">not</span> invalidate the dependent cursors <span class="token keyword">if</span> <span class="token keyword">set</span> <span class="token keyword">to</span> <span class="token boolean">TRUE</span><span class="token punctuation">.</span> The <span class="token keyword">procedure</span> invalidates the dependent cursors immediately <span class="token keyword">if</span> <span class="token keyword">set</span> <span class="token keyword">to</span> <span class="token boolean">FALSE</span><span class="token punctuation">.</span>
<span class="token keyword">force</span>:即使表锁住了也收集统计信息<span class="token punctuation">.</span>


这是对命令与工具包的一些总结
<span class="token number">1</span>、对于分区表，建议使用DBMS_STATS，而不是使用<span class="token keyword">Analyze</span>语句。
a<span class="token punctuation">)</span> 可以并行进行，对多个用户，多个<span class="token keyword">Table</span>
b<span class="token punctuation">)</span> 可以得到整个分区表的数据和单个分区的数据。
c<span class="token punctuation">)</span> 可以在不同级别上<span class="token keyword">Compute</span> <span class="token keyword">Statistics</span>：单个分区，子分区，全表，所有分区
d<span class="token punctuation">)</span> 可以倒出统计信息
e<span class="token punctuation">)</span> 可以用户自动收集统计信息
<span class="token number">2</span>、DBMS_STATS的缺点
a<span class="token punctuation">)</span> 不能Validate Structure
b<span class="token punctuation">)</span> 不能收集CHAINED <span class="token keyword">ROWS</span><span class="token punctuation">,</span> 不能收集CLUSTER <span class="token keyword">TABLE</span>的信息，这两个仍旧需要使用<span class="token keyword">Analyze</span>语句。
c<span class="token punctuation">)</span> DBMS_STATS 默认不对索引进行<span class="token keyword">Analyze</span>，因为默认<span class="token keyword">Cascade</span>是<span class="token boolean">False</span>，需要手工指定为<span class="token boolean">True</span>
<span class="token number">3</span>、对于oracle <span class="token number">9</span>里面的External <span class="token keyword">Table</span>，<span class="token keyword">Analyze</span>不能使用，只能使用DBMS_STATS来收集信息。

</code></pre></div><h4 id="查询正在执行的sql"><a href="#查询正在执行的sql" class="header-anchor">#</a> 查询正在执行的SQL</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> b<span class="token punctuation">.</span>inst_id<span class="token punctuation">,</span>b<span class="token punctuation">.</span>sid oracleID<span class="token punctuation">,</span>
       b<span class="token punctuation">.</span>username 登录Oracle用户名<span class="token punctuation">,</span>
       b<span class="token punctuation">.</span><span class="token keyword">serial</span><span class="token comment">#,</span>
       spid 操作系统ID<span class="token punctuation">,</span>
       paddr<span class="token punctuation">,</span>
       sql_text 正在执行的<span class="token keyword">SQL</span><span class="token punctuation">,</span>
       sql_fulltext<span class="token punctuation">,</span>
       b<span class="token punctuation">.</span>machine 计算机名<span class="token punctuation">,</span>
       b<span class="token punctuation">.</span>EVENT<span class="token punctuation">,</span>
       <span class="token string">'alter system kill session '''</span><span class="token operator">||</span>b<span class="token punctuation">.</span>sid<span class="token operator">||</span><span class="token string">','</span><span class="token operator">||</span>b<span class="token punctuation">.</span><span class="token keyword">serial</span><span class="token comment">#||''';'</span>
<span class="token keyword">FROM</span> gv$process a<span class="token punctuation">,</span> gv$<span class="token keyword">session</span> b<span class="token punctuation">,</span> gv$<span class="token keyword">sql</span> c
<span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>addr <span class="token operator">=</span> b<span class="token punctuation">.</span>paddr
   <span class="token operator">AND</span> b<span class="token punctuation">.</span>sql_hash_value <span class="token operator">=</span> c<span class="token punctuation">.</span>hash_value
   <span class="token operator">and</span> a<span class="token punctuation">.</span>inst_id<span class="token operator">=</span><span class="token number">1</span>
   <span class="token operator">and</span> b<span class="token punctuation">.</span>inst_id<span class="token operator">=</span><span class="token number">1</span>
   <span class="token operator">and</span> c<span class="token punctuation">.</span>inst_id<span class="token operator">=</span><span class="token number">1</span>
   <span class="token operator">and</span> b<span class="token punctuation">.</span><span class="token keyword">status</span><span class="token operator">=</span><span class="token string">'ACTIVE'</span>
   <span class="token punctuation">;</span>
</code></pre></div><h4 id="查询sql平均耗时"><a href="#查询sql平均耗时" class="header-anchor">#</a> 查询SQL平均耗时</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">--根据平均耗时大小排序</span>
<span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>SQL_TEXT<span class="token punctuation">,</span>
       a<span class="token punctuation">.</span>SQL_ID<span class="token punctuation">,</span>
       a<span class="token punctuation">.</span>EXECUTIONS <span class="token string">&quot;总执行次数&quot;</span><span class="token punctuation">,</span>
       nvl<span class="token punctuation">(</span>a<span class="token punctuation">.</span>ELAPSED_TIME<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">1000</span> <span class="token string">&quot;总耗时(秒)&quot;</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span>nvl<span class="token punctuation">(</span>a<span class="token punctuation">.</span>ELAPSED_TIME<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span>
       nvl<span class="token punctuation">(</span>decode<span class="token punctuation">(</span>a<span class="token punctuation">.</span>EXECUTIONS<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>EXECUTIONS<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">1000</span> <span class="token string">&quot;平均耗时（秒）&quot;</span><span class="token punctuation">,</span>
       a<span class="token punctuation">.</span>PARSE_CALLS <span class="token string">&quot;硬解析次数&quot;</span><span class="token punctuation">,</span>
       a<span class="token punctuation">.</span>DISK_READS <span class="token string">&quot;物理读次数&quot;</span><span class="token punctuation">,</span>
       a<span class="token punctuation">.</span>BUFFER_GETS <span class="token string">&quot;读缓存区次数&quot;</span><span class="token punctuation">,</span>
       a<span class="token punctuation">.</span>FIRST_LOAD_TIME <span class="token string">&quot;sql开始执行时间&quot;</span>
  <span class="token keyword">FROM</span> v$<span class="token keyword">SQL</span> a
 <span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>first_load_time <span class="token operator">like</span> <span class="token string">'2022-07-13%'</span>
 <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token punctuation">(</span>nvl<span class="token punctuation">(</span>a<span class="token punctuation">.</span>ELAPSED_TIME<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span>
          nvl<span class="token punctuation">(</span>decode<span class="token punctuation">(</span>a<span class="token punctuation">.</span>EXECUTIONS<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>EXECUTIONS<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token number">1000</span> <span class="token keyword">desc</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="慢查询耗时"><a href="#慢查询耗时" class="header-anchor">#</a> 慢查询耗时</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 慢查询耗时</span>
<span class="token keyword">select</span> <span class="token operator">*</span>
 <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> sa<span class="token punctuation">.</span>SQL_TEXT <span class="token string">&quot;执行 SQL&quot;</span><span class="token punctuation">,</span>
        sa<span class="token punctuation">.</span>EXECUTIONS <span class="token string">&quot;执行次数&quot;</span><span class="token punctuation">,</span>
        <span class="token function">round</span><span class="token punctuation">(</span>sa<span class="token punctuation">.</span>ELAPSED_TIME <span class="token operator">/</span> <span class="token number">1000000</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;总执行时间&quot;</span><span class="token punctuation">,</span>
        <span class="token function">round</span><span class="token punctuation">(</span>sa<span class="token punctuation">.</span>ELAPSED_TIME <span class="token operator">/</span> <span class="token number">1000000</span> <span class="token operator">/</span> sa<span class="token punctuation">.</span>EXECUTIONS<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;平均执行时间&quot;</span><span class="token punctuation">,</span>
        sa<span class="token punctuation">.</span>COMMAND_TYPE<span class="token punctuation">,</span>
        sa<span class="token punctuation">.</span>PARSING_USER_ID <span class="token string">&quot;用户ID&quot;</span><span class="token punctuation">,</span>
        u<span class="token punctuation">.</span>username <span class="token string">&quot;用户名&quot;</span><span class="token punctuation">,</span>
        sa<span class="token punctuation">.</span>HASH_VALUE
     <span class="token keyword">from</span> v$sqlarea sa
     <span class="token keyword">left</span> <span class="token keyword">join</span> all_users u
      <span class="token keyword">on</span> sa<span class="token punctuation">.</span>PARSING_USER_ID <span class="token operator">=</span> u<span class="token punctuation">.</span>user_id
     <span class="token keyword">where</span> sa<span class="token punctuation">.</span>EXECUTIONS <span class="token operator">&gt;</span> <span class="token number">0</span>
     <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token punctuation">(</span>sa<span class="token punctuation">.</span>ELAPSED_TIME <span class="token operator">/</span> sa<span class="token punctuation">.</span>EXECUTIONS<span class="token punctuation">)</span> <span class="token keyword">desc</span><span class="token punctuation">)</span>
 <span class="token keyword">where</span> rownum <span class="token operator">&lt;=</span> <span class="token number">50</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="找到正在运行的存储过程并杀死"><a href="#找到正在运行的存储过程并杀死" class="header-anchor">#</a> 找到正在运行的存储过程并杀死</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- ddl锁 dba_ddl_locks</span>
<span class="token number">1.</span>查询正在运行的存储过程（包、函数等）
<span class="token keyword">select</span> name <span class="token keyword">from</span> v$db_object_cache <span class="token keyword">where</span> <span class="token keyword">type</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'PROCEDURE'</span><span class="token punctuation">,</span> <span class="token string">'PACKAGE BODY'</span><span class="token punctuation">,</span> <span class="token string">'PACKAGE'</span><span class="token punctuation">)</span> <span class="token operator">and</span> locks <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">and</span> pins <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">-- 获取ddl锁的信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dba_ddl_locks <span class="token keyword">where</span> owner <span class="token operator">=</span> <span class="token string">'XXX'</span> <span class="token operator">AND</span> name<span class="token operator">=</span><span class="token string">'XXX'</span><span class="token punctuation">;</span>

<span class="token number">2.</span>找到对应存储过程的sid
<span class="token keyword">select</span><span class="token comment">/*+rule */</span> sid <span class="token keyword">from</span> v$access o <span class="token keyword">where</span> OWNER<span class="token operator">=</span><span class="token string">'过程的所属用户'</span> <span class="token operator">AND</span> o<span class="token punctuation">.</span>OBJECT <span class="token operator">=</span> <span class="token string">'存储过程'</span>   <span class="token comment">--（参数是存储过程名称）</span>

<span class="token number">3.</span>根据sid找到对应的<span class="token keyword">serial</span><span class="token comment">#</span>
<span class="token keyword">select</span> sid<span class="token punctuation">,</span><span class="token keyword">serial</span><span class="token comment"># from v$session a WHERE A.SID='sid'</span>

<span class="token number">4.</span>终止运行存储过程
<span class="token keyword">alter</span> system <span class="token keyword">kill</span> <span class="token keyword">session</span> <span class="token string">'sid,serial#'</span>  <span class="token punctuation">(</span>例如：<span class="token keyword">alter</span> system <span class="token keyword">kill</span> <span class="token keyword">session</span> <span class="token string">'sid,serial#'</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="其他"><a href="#其他" class="header-anchor">#</a> 其他</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">--查询当前用户使用了多少还原表空间</span>
<span class="token keyword">select</span> d<span class="token punctuation">.</span>username<span class="token punctuation">,</span>c<span class="token punctuation">.</span>name<span class="token punctuation">,</span>b<span class="token punctuation">.</span>writes
<span class="token keyword">from</span> v$<span class="token keyword">transaction</span> a<span class="token punctuation">,</span>v$rollstat b<span class="token punctuation">,</span>v$rollname c<span class="token punctuation">,</span>v$<span class="token keyword">session</span> d
<span class="token keyword">where</span> d<span class="token punctuation">.</span>taddr<span class="token operator">=</span>a<span class="token punctuation">.</span>addr
  <span class="token operator">and</span> a<span class="token punctuation">.</span>xidusn<span class="token operator">=</span>b<span class="token punctuation">.</span>usn
  <span class="token operator">and</span> b<span class="token punctuation">.</span>usn<span class="token operator">=</span>c<span class="token punctuation">.</span>usn
<span class="token keyword">order</span> <span class="token keyword">by</span> d<span class="token punctuation">.</span>username<span class="token punctuation">;</span>

<span class="token comment">-- 查看临时表空间的使用情况</span>
<span class="token keyword">select</span> ts<span class="token punctuation">.</span>name<span class="token punctuation">,</span>ts<span class="token punctuation">.</span>phyrds <span class="token string">&quot;reads&quot;</span><span class="token punctuation">,</span>ts<span class="token punctuation">.</span>phywrts <span class="token string">&quot;writes&quot;</span><span class="token punctuation">,</span>ts<span class="token punctuation">.</span>phyblkrd<span class="token punctuation">,</span>ts<span class="token punctuation">.</span>phyblkwrt<span class="token punctuation">,</span>ts<span class="token punctuation">.</span>readtim <span class="token string">&quot;rtime&quot;</span><span class="token punctuation">,</span>ts<span class="token punctuation">.</span>writetim <span class="token string">&quot;wtime&quot;</span>
  <span class="token keyword">from</span> v$<span class="token keyword">tablespace</span> ts<span class="token punctuation">,</span>v$tempfile tf <span class="token punctuation">,</span>v$tempstat ts
 <span class="token keyword">where</span> ts<span class="token punctuation">.</span>ts<span class="token comment">#=tf.ts#</span>
   <span class="token operator">and</span> tf<span class="token punctuation">.</span><span class="token keyword">file</span><span class="token comment">#=ts.file#;</span>

<span class="token comment">-- 查看数据文件的i/o分布情况</span>
<span class="token keyword">select</span> name<span class="token punctuation">,</span>phyrds<span class="token punctuation">,</span>phywrts<span class="token punctuation">,</span>readtim<span class="token punctuation">,</span>writetim
  <span class="token keyword">from</span> v$filestat a<span class="token punctuation">,</span>v$datafile b
 <span class="token keyword">where</span> a<span class="token punctuation">.</span><span class="token keyword">file</span><span class="token comment">#=b.file#</span>
 <span class="token keyword">order</span> <span class="token keyword">by</span> readtim <span class="token keyword">desc</span><span class="token punctuation">;</span>

<span class="token comment">-- 查看连接oracle的所有机器的连接数和状态</span>
<span class="token keyword">select</span> machine<span class="token punctuation">,</span><span class="token keyword">status</span><span class="token punctuation">,</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> v$<span class="token keyword">session</span> <span class="token keyword">group</span> <span class="token keyword">by</span> machine<span class="token punctuation">,</span><span class="token keyword">status</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token keyword">status</span><span class="token punctuation">;</span>

<span class="token comment">/*
SGA(System Global Area)：由所有服务进程和后台进程共享；
PGA(Program Global Area)：由每个服务进程、后台进程专有；每个进程都有一个PGA。
*/</span>
<span class="token comment">-- oracle的PGA、SGA和process count</span>
<span class="token keyword">select</span> <span class="token string">'SGA'</span> <span class="token keyword">AS</span> NAME<span class="token punctuation">,</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token string">'M'</span> <span class="token keyword">AS</span> <span class="token string">&quot;SIZE(M)&quot;</span> <span class="token keyword">from</span> v$sga
<span class="token keyword">UNION</span>
<span class="token keyword">select</span> <span class="token string">'PGA'</span> <span class="token keyword">AS</span> NAME<span class="token punctuation">,</span><span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token string">'M'</span> <span class="token keyword">AS</span> <span class="token string">&quot;SIZE(M)&quot;</span> <span class="token keyword">from</span> v$pgastat <span class="token keyword">where</span> name<span class="token operator">=</span><span class="token string">'total PGA allocated'</span>
<span class="token keyword">UNION</span>
<span class="token keyword">select</span> <span class="token string">'TOTAL'</span> <span class="token keyword">AS</span> NAME<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">from</span> v$sga<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token keyword">value</span><span class="token operator">/</span><span class="token number">1024</span><span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">from</span> v$pgastat <span class="token keyword">where</span> name<span class="token operator">=</span><span class="token string">'total PGA allocated'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token string">'M'</span> <span class="token keyword">AS</span> <span class="token string">&quot;SIZE(M)&quot;</span> <span class="token keyword">FROM</span> DUAL
<span class="token keyword">UNION</span>
<span class="token keyword">SELECT</span> NAME<span class="token punctuation">,</span>TO_CHAR<span class="token punctuation">(</span><span class="token keyword">VALUE</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> V$PGASTAT <span class="token keyword">WHERE</span> NAME<span class="token operator">=</span><span class="token string">'process count'</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="scn"><a href="#scn" class="header-anchor">#</a> SCN</h2> <hr> <div class="language-sql extra-class"><pre class="language-sql"><code>SCN（System Change Number），也就是通常所说的系统改变号，是数据库中非常重要的一个数据结构。
SCN用以标识数据库在某个确切时刻提交的版本。在事务提交时，它被赋予一个唯一的标识事务的SCN。SCN同时被作为Oracle数据库的内部时钟机制，可被看做逻辑时钟，每个数据库都有一个全局的SCN生成器。
作为数据库内部的逻辑时钟，数据库事务依SCN而排序，Oracle也依据SCN来实现一致性读（<span class="token keyword">Read</span> Consistency）等重要数据库功能。另外对于分布式事务（<span class="token keyword">Distributed</span> <span class="token keyword">Transactions</span>），SCN也极为重要，这里不做更多介绍。
SCN在数据库中是唯一的，并随时间而增加，但是可能并不连贯。除非重建数据库，SCN的值永远不会被重置为<span class="token number">0.</span>
一直以来，对于SCN有很多争议，很多人认为SCN是指System <span class="token keyword">Commit</span> Number，而通常SCN在提交时才变化，所以很多时候，这两个名词经常在文档中反复出现。即使在Oracle的官方文档中，SCN也常以System Change<span class="token operator">/</span><span class="token keyword">Commit</span> Number两种形式出现。
到底是哪个词其实不是很重要，重要的是需要知道SCN是Oracle内部的时钟机制，Oracle通过SCN来维护数据库的一致性，并通过SCN实施Oracle至关重要的恢复机制。
SCN在数据库中是无处不在，常见的事务表、控制文件、数据文件头、日志文件、数据块头等都记录有SCN值。
冠以不同前缀，SCN也有了不同的名称，如检查点SCN（Checkpint SCN）、Resetlogs SCN等。

<span class="token comment">-- 当前scn号和时间的对应关系：</span>
<span class="token keyword">select</span> dbms_flashback<span class="token punctuation">.</span>get_system_change_number<span class="token punctuation">,</span>SCN_TO_TIMESTAMP<span class="token punctuation">(</span>dbms_flashback<span class="token punctuation">.</span>get_system_change_number<span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>

<span class="token comment">-- 查询当前scn：</span>
<span class="token keyword">select</span> CURRENT_SCN <span class="token keyword">from</span> v$<span class="token keyword">database</span><span class="token punctuation">;</span>
<span class="token keyword">select</span> dbms_flashback<span class="token punctuation">.</span>get_system_change_number <span class="token keyword">from</span> dual<span class="token punctuation">;</span>

<span class="token comment">-- SCN与时间的相互转换</span>
将SCN转换成时间戳: SCN_TO_TIMESTAMP<span class="token punctuation">(</span>scn_number<span class="token punctuation">)</span>
将时间戳转换成SCN: TIMESTAMP_TO_SCN<span class="token punctuation">(</span><span class="token keyword">timestamp</span><span class="token punctuation">)</span>

<span class="token comment">-- 数据行伪列保存数据最后更新时间  select ora_rowscn from table_name;</span>
<span class="token comment">-- 系统表保存scn与时间戳对应关系（保留5天）   SELECT * FROM sys.smon_scn_time</span>

了解更多请核查看博客：https:<span class="token comment">//blog.csdn.net/fuwencaho/article/details/21256973</span>

</code></pre></div><h3 id="oracle-表闪回"><a href="#oracle-表闪回" class="header-anchor">#</a> Oracle 表闪回</h3> <p>查看是否开启闪回功能：<code>SELECT flashback_on FROM V$DATABASE;</code></p> <h4 id="查询历史版本数据-闪回查询"><a href="#查询历史版本数据-闪回查询" class="header-anchor">#</a> 查询历史版本数据（闪回查询）</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 查询出类似拉链表的数据（包含历史版本）</span>
<span class="token keyword">SELECT</span> 
       字段名<span class="token punctuation">,</span>
       TO_CHAR<span class="token punctuation">(</span>VERSIONS_STARTTIME<span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd hh24:mi:ss'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> VERSIONS_STARTTIME<span class="token punctuation">,</span>
       TO_CHAR<span class="token punctuation">(</span>VERSIONS_ENDTIME<span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd hh24:mi:ss'</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> VERSIONS_ENDTIME<span class="token punctuation">,</span>
       VERSIONS_OPERATION
  <span class="token keyword">FROM</span> 表名 VERSIONS <span class="token operator">BETWEEN</span> <span class="token keyword">TIMESTAMP</span> MINVALUE <span class="token operator">AND</span> MAXVALUE
 <span class="token keyword">WHERE</span> VERSIONS_STARTTIME <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> VERSIONS_STARTTIME <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="恢复已删除的表"><a href="#恢复已删除的表" class="header-anchor">#</a> 恢复已删除的表</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 恢复已删除的表</span>
flashback <span class="token keyword">table</span> table_name <span class="token keyword">to</span> before <span class="token keyword">drop</span><span class="token punctuation">;</span>

<span class="token comment">-- 若删除后已经创建了同名的表（ORA-38312）</span>
<span class="token comment">-- 如果表名重复，则闪回时遵循后入先出的原则。</span>
flashback <span class="token keyword">table</span> test <span class="token keyword">to</span> before <span class="token keyword">drop</span> <span class="token keyword">rename</span> <span class="token keyword">to</span> test1<span class="token punctuation">;</span>
</code></pre></div><p>扩展：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 闪回时可指明被恢复的回收站对象</span>
flashback <span class="token keyword">table</span> <span class="token string">&quot;BIN$AyId7ZbBjWngUKjADQIIuA==$0&quot;</span> <span class="token keyword">to</span> before <span class="token keyword">drop</span><span class="token punctuation">;</span>

<span class="token comment">-- 闪回删表的工作原理是：当“drop table”命令执行时，表及其索引并没有被真正删除，其所占空间只是分配给了另一个数据库对象：回收站对象，本质上相当于重命名。注意：表空间在自动增长的压力下会按照先入先出的规则将回收站对象的空间分配给需要空间的段，在将回收站对象耗尽之前数据文件是不会自动增长的。</span>
<span class="token comment">-- Oracle启用回收站功能后，使用drop table ...语句删除一张表时，并不会将表给删除，而是以一定的格式重新对表重命名，然后将该表放到数据字典表中，在遇到表空间不足的情况下自动清理这些表，释放被占用的空间，让其它对象能够使用这些空间。</span>

<span class="token comment">-- 可禁用回收站功能</span>
<span class="token keyword">alter</span> system <span class="token keyword">set</span> recyclebin<span class="token operator">=</span><span class="token string">'OFF'</span> scope<span class="token operator">=</span>spfile<span class="token punctuation">;</span>

<span class="token comment">-- 清理指定用户的表空间中的回收站对象</span>
<span class="token keyword">PURGE</span> <span class="token keyword">TABLESPACE</span> USERS <span class="token keyword">user</span> user_name<span class="token punctuation">;</span>
<span class="token comment">-- 删除当前用户回收站的所有对象</span>
<span class="token keyword">purge</span> recyclebin<span class="token punctuation">;</span>
    
<span class="token comment">-- dbms_flashback包</span>
<span class="token comment">-- 利用dbms_flashback包的enable_at_time或enable_at_scn存储过程锁定一个会话级别的闪回时间目标，即进入闪回模式，随后的查询命令可以省略“as of”，直到调用dbms_flashback_disable存储过程将其关闭为止。</span>
</code></pre></div><h4 id="恢复表到某个时间点"><a href="#恢复表到某个时间点" class="header-anchor">#</a> 恢复表到某个时间点</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 确定要恢复的表的时间点</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> table_name <span class="token keyword">AS</span> <span class="token keyword">OF</span> <span class="token keyword">TIMESTAMP</span><span class="token punctuation">(</span>to_timestamp<span class="token punctuation">(</span><span class="token string">'2024-08-29 19:00:00'</span><span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd hh24:mi:ss'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 将表恢复到指定时间点</span>
FLASHBACK <span class="token keyword">TABLE</span> table_name <span class="token keyword">TO</span> <span class="token keyword">TIMESTAMP</span><span class="token punctuation">(</span>to_timestamp<span class="token punctuation">(</span><span class="token string">'2024-08-29 19:00:00'</span><span class="token punctuation">,</span> <span class="token string">'yyyy-MM-dd hh24:mi:ss'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- 1. &quot;FLASHBACK TABLE&quot;命令的执行者必须有&quot;FLASHBACK ANY TABLE&quot;系统权限或者在被闪回的表上具有&quot;FLASHBACK&quot;对象权限。</span>
<span class="token comment">-- 2. 需启用行移动  alter table DEBT_T_FILE_INFO_FABZ_BAK enable row movement;</span>
<span class="token comment">-- 3. &quot;FLASHBACK TABLE&quot;属于DDL命令，隐式提交。</span>
<span class="token comment">-- 4. SYS用户的任何表无法使用此功能。</span>
</code></pre></div><h2 id="logminer"><a href="#logminer" class="header-anchor">#</a> LogMiner</h2> <hr> <p>众所周知，所有对用户数据和数据字典的改变都记录在Oracle的Redo Log中，因此，Redo Log包含了所有进行恢复操作所需要的信息。但是，原始的Redo Log文件无法看懂，所以，Oracle从8i以后提供了一个非常有用的分析工具，称为LogMiner。使用该工具可以轻松获得Redo Log文件（包含归档日志文件）中的具体内容。特别是该工具可以分析出所有对于数据库的DML操作（INSERT、UPDATE、DELETE等）语句。Oracle 9i后可以分析DDL语句，另外还可分析得到一些必要的回滚SQL语句。LogMiner一个最重要的用途就是不用全部恢复数据库就可以恢复数据库的某个变化。该工具特别适用于调试、审计或者回退某个特定的事务。
LogMiner工具既可以用来分析在线日志，也可以用来分析离线日志文件，既可以分析本身自己数据库的重作日志文件，也可以用来分析其它数据库的重作日志文件。当分析其它数据库的重作日志文件时，需要注意的是，LogMiner必须使用被分析数据库实例产生的字典文件，而不是安装LogMiner的数据库产生的字典文件，另外，必须保证安装LogMiner数据库的字符集和被分析数据库的字符集相同。源数据库（Source Database）平台必须和分析数据库（Mining Database）平台一样。
Oracle通过LogMiner工具对Redo Log进行挖掘，显示出一系列可读的信息，该过程称为日志挖掘。LogMiner通过V$LOGMNR_CONTENTS视图显示Redo Log中的信息。</p> <p>总的说来，LogMiner工具的主要用途有：</p> <ol><li>跟踪数据库的变化：可以离线地跟踪数据库的变化，而不会影响在线系统的性能</li> <li>回退数据库的变化：回退特定的变化数据，减少Point-In-Time Recovery的执行</li> <li>优化和扩容计划：可通过分析日志文件中的数据以分析数据的增长模式</li> <li>确定数据库的逻辑损坏时间：准确定位操作执行的时间和SCN</li> <li>确定事务级要执行的精细逻辑恢复操作，可以取得相应的UNDO操作</li> <li>执行后续审计</li></ol> <p>了解更多请查看博客： https://blog.csdn.net/yes_is_ok/article/details/79296614</p> <h2 id="动态性能视图-x-v-gv-v-gv"><a href="#动态性能视图-x-v-gv-v-gv" class="header-anchor">#</a> 动态性能视图(x$,v$,gv$,v_$,gv_$)</h2> <hr> <p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/12.2/refrn/V-ACCESS.html#GUID-760F107D-7D5F-4170-AB9C-DF80D03DC1B7" target="_blank" rel="noopener noreferrer">官方文档12.2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-sql extra-class"><pre class="language-sql"><code>v$<span class="token keyword">database</span> 数据库信息
v$datafile 数据文件信息
v$controlfile 控制文件信息
v$logfile 重做日志信息
v$instance 数据库实例信息
v$log 日志组信息
v$loghist 日志历史信息
v$sga 数据库SGA信息
v$parameter 初始化参数信息
v$process 数据库服务器进程信息
v$bgprocess 数据库后台进程信息
v$controlfile_record_section 控制文件记载的各部分信息
v$thread 线程信息
v$datafile_header 数据文件头所记载的信息
v$archived_log归档日志信息
v$archive_dest 归档日志的设置信息
v$logmnr_contents 归档日志分析的DML DDL结果信息
v$logmnr_dictionary 日志分析的字典文件信息
v$logmnr_logs 日志分析的日志列表信息
v$<span class="token keyword">tablespace</span> 表空间信息
v$tempfile 临时文件信息
v$filestat 数据文件的I<span class="token operator">/</span>O统计信息
v$undostat Undo数据信息
v$rollname 在线回滚段信息
v$<span class="token keyword">session</span> 会话信息
v$<span class="token keyword">transaction</span> 事务信息
v$rollstat 回滚段统计信息
v$pwfile_users 特权用户信息
v$sqlarea 当前查询过的<span class="token keyword">sql</span>语句访问过的资源及相关的信息
v$<span class="token keyword">sql</span> 与v$sqlarea基本相同的相关信息
v$sysstat 数据库系统状态信息
</code></pre></div><h2 id="常用系统表"><a href="#常用系统表" class="header-anchor">#</a> 常用系统表</h2> <p><a href="https://blog.csdn.net/qq814965130/article/details/79305220?spm=1001.2101.3001.6650.5&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-5.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-5.pc_relevant_default&amp;utm_relevant_index=10" target="_blank" rel="noopener noreferrer">原文链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>dba_开头</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>
dba_users 数据库用户信息
dba_segments 表段信息
dba_extents 数据区信息
dba_objects 数据库对象信息
dba_tablespaces 数据库表空间信息
dba_data_files 数据文件设置信息
dba_temp_files 临时数据文件信息
dba_rollback_segs 回滚段信息
dba_ts_quotas 用户表空间配额信息
dba_free_space 数据库空闲空间信息
dba_profiles 数据库用户资源限制信息
dba_sys_privs 用户的系统权限信息
dba_tab_privs 用户具有的对象权限信息
dba_col_privs 用户具有的列对象权限信息
dba_role_privs 用户具有的角色信息
dba_audit_trail 审计跟踪记录信息
dba_stmt_audit_opts 审计设置信息
dba_audit_object 对象审计结果信息
dba_audit_session 会话审计结果信息
dba_indexes 用户模式的索引信息
</code></pre></div><p><strong>user_开头</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>user_objects 用户对象信息
user_source 数据库用户的所有资源对象信息
user_segments 用户的表段信息
user_tables 用户的表对象信息
user_tab_columns 用户的表列信息
user_col_comments 用户的表列注释信息
user_constraints 用户的对象约束信息
user_sys_privs 当前用户的系统权限信息
user_tab_privs 当前用户的对象权限信息
user_col_privs 当前用户的表列权限信息
user_role_privs 当前用户的角色权限信息
user_indexes 用户的索引信息
user_ind_columns 用户的索引对应的表列信息
user_cons_columns 用户的约束对应的表列信息
user_clusters 用户的所有簇信息
user_clu_columns 用户的簇所包含的内容信息
user_cluster_hash_expressions 散列簇的信息

</code></pre></div><p><strong>all_开头</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code>all_users 数据库所有用户的信息
all_objects 数据库所有的对象的信息
all_def_audit_opts 所有默认的审计设置信息
all_tables 所有的表对象信息
all_indexes 所有的数据库对象索引的信息

session_开头
session_roles 会话的角色信息
session_privs 会话的权限信息

index_开头
index_stats 索引的设置和存储信息

<span class="token operator">*</span><span class="token operator">*</span>伪表<span class="token operator">*</span><span class="token operator">*</span>
dual 系统伪列表信息
</code></pre></div><h3 id="实例"><a href="#实例" class="header-anchor">#</a> 实例</h3> <h4 id="查看视图中用到的表和视图"><a href="#查看视图中用到的表和视图" class="header-anchor">#</a> 查看视图中用到的表和视图</h4> <div class="language-sql extra-class"><pre class="language-sql"><code>   <span class="token keyword">SELECT</span> NAME<span class="token punctuation">,</span> REFERENCED_TYPE<span class="token punctuation">,</span> <span class="token keyword">REPLACE</span><span class="token punctuation">(</span>TO_CHAR<span class="token punctuation">(</span>WM_CONCAT<span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> REFERENCED_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">','</span><span class="token punctuation">,</span> chr<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token keyword">FROM</span> SYS<span class="token punctuation">.</span>ALL_DEPENDENCIES
    <span class="token keyword">WHERE</span> <span class="token keyword">TYPE</span> <span class="token operator">=</span> <span class="token string">'VIEW'</span>
      <span class="token operator">AND</span> NAME <span class="token operator">=</span> UPPER<span class="token punctuation">(</span><span class="token string">'视图名'</span><span class="token punctuation">)</span>
      <span class="token operator">AND</span> REFERENCED_TYPE <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'TABLE'</span><span class="token punctuation">,</span> <span class="token string">'VIEW'</span><span class="token punctuation">)</span>
      <span class="token operator">AND</span> OWNER <span class="token operator">=</span> <span class="token string">'用户名'</span>
 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> NAME<span class="token punctuation">,</span> REFERENCED_TYPE
 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> REFERENCED_TYPE
<span class="token punctuation">;</span>
</code></pre></div><h4 id="用到-某个表-的视图"><a href="#用到-某个表-的视图" class="header-anchor">#</a> 用到 某个表 的视图</h4> <div class="language-sql extra-class"><pre class="language-sql"><code>
   <span class="token keyword">SELECT</span> NAME<span class="token punctuation">,</span> REFERENCED_TYPE<span class="token punctuation">,</span> <span class="token keyword">REPLACE</span><span class="token punctuation">(</span>TO_CHAR<span class="token punctuation">(</span>WM_CONCAT<span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> REFERENCED_NAME<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">','</span><span class="token punctuation">,</span> chr<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token keyword">FROM</span> SYS<span class="token punctuation">.</span>ALL_DEPENDENCIES
    <span class="token keyword">WHERE</span> <span class="token keyword">TYPE</span> <span class="token operator">=</span> <span class="token string">'VIEW'</span>
      <span class="token operator">AND</span> REFERENCED_NAME <span class="token operator">=</span> <span class="token string">'表名'</span>
      <span class="token operator">AND</span> OWNER <span class="token operator">=</span> <span class="token string">'用户名'</span>
 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> NAME<span class="token punctuation">,</span> REFERENCED_TYPE
 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> REFERENCED_TYPE
<span class="token punctuation">;</span>
</code></pre></div><h4 id="查看视图或表创建语句"><a href="#查看视图或表创建语句" class="header-anchor">#</a> 查看视图或表创建语句</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> all_views <span class="token keyword">where</span> VIEW_NAME <span class="token operator">=</span> UPPER<span class="token punctuation">(</span><span class="token string">'视图名'</span><span class="token punctuation">)</span> <span class="token operator">AND</span> OWNER <span class="token operator">=</span> <span class="token string">'用户名'</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="查询建表语句-不含注释"><a href="#查询建表语句-不含注释" class="header-anchor">#</a> 查询建表语句（不含注释）</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> dbms_metadata<span class="token punctuation">.</span>get_ddl<span class="token punctuation">(</span><span class="token string">'TABLE'</span><span class="token punctuation">,</span>upper<span class="token punctuation">(</span><span class="token string">'tablename'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
</code></pre></div><h4 id="查看函数、存储过程、触发器、包等创建语句"><a href="#查看函数、存储过程、触发器、包等创建语句" class="header-anchor">#</a> 查看函数、存储过程、触发器、包等创建语句</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> OWNER<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> <span class="token keyword">TYPE</span><span class="token punctuation">,</span> listagg<span class="token punctuation">(</span><span class="token keyword">TEXT</span><span class="token punctuation">)</span> <span class="token keyword">WITHIN</span> <span class="token keyword">GROUP</span><span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> line<span class="token punctuation">)</span> <span class="token keyword">AS</span> <span class="token keyword">TEXT</span>
  <span class="token keyword">FROM</span> ALL_SOURCE
 <span class="token keyword">WHERE</span> NAME <span class="token operator">=</span> <span class="token string">'OBJECT_NAME'</span>
   <span class="token operator">AND</span> owner <span class="token operator">=</span> <span class="token string">'USER_NAME'</span>
 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> OWNER<span class="token punctuation">,</span> NAME<span class="token punctuation">,</span> <span class="token keyword">TYPE</span>
</code></pre></div><h4 id="迁移数据-大批量操作数据-前禁用索引"><a href="#迁移数据-大批量操作数据-前禁用索引" class="header-anchor">#</a> 迁移数据（大批量操作数据）前禁用索引！！！</h4> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token string">'ALTER INDEX '</span> <span class="token operator">||</span> idx<span class="token punctuation">.</span>index_name <span class="token operator">||</span> <span class="token string">' UNUSABLE;'</span><span class="token punctuation">,</span>
       <span class="token string">'ALTER INDEX '</span> <span class="token operator">||</span> idx<span class="token punctuation">.</span>index_name <span class="token operator">||</span> <span class="token string">' REBUILD;'</span>
  <span class="token keyword">FROM</span> user_indexes idx
  <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> USER_IND_COLUMNS IDXC
    <span class="token keyword">ON</span> IDX<span class="token punctuation">.</span>table_name <span class="token operator">=</span> IDXC<span class="token punctuation">.</span>TABLE_NAME
   <span class="token operator">AND</span> IDX<span class="token punctuation">.</span>INDEX_NAME <span class="token operator">=</span> IDXC<span class="token punctuation">.</span>INDEX_NAME
 <span class="token keyword">WHERE</span> IDX<span class="token punctuation">.</span>UNIQUENESS <span class="token operator">&lt;&gt;</span> <span class="token string">'UNIQUE'</span>
   <span class="token operator">AND</span> IDX<span class="token punctuation">.</span>table_name <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> UPPER<span class="token punctuation">(</span>DATA_TARGET<span class="token punctuation">)</span>
                            <span class="token keyword">FROM</span> DEBT_T_EXC_CONFIG_PARAM
                           <span class="token keyword">WHERE</span> EXC_TYPE <span class="token operator">=</span> <span class="token string">'QY_IN'</span><span class="token punctuation">)</span>  <span class="token comment">/*指定表清单*/</span>
   <span class="token operator">AND</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span>
 <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token number">1</span>
          <span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> ucc<span class="token punctuation">.</span>table_name<span class="token punctuation">,</span> ucc<span class="token punctuation">.</span>COLUMN_NAME
                  <span class="token keyword">FROM</span> USER_CONS_COLUMNS ucc
                  <span class="token keyword">JOIN</span> USER_CONSTRAINTS uc
                    <span class="token keyword">ON</span> ucc<span class="token punctuation">.</span>CONSTRAINT_NAME <span class="token operator">=</span> uc<span class="token punctuation">.</span>CONSTRAINT_NAME
                 <span class="token keyword">WHERE</span> uc<span class="token punctuation">.</span>CONSTRAINT_TYPE <span class="token operator">=</span> <span class="token string">'P'</span><span class="token punctuation">)</span> t
         <span class="token keyword">WHERE</span> idx<span class="token punctuation">.</span>TABLE_NAME <span class="token operator">=</span> t<span class="token punctuation">.</span>table_name
           <span class="token operator">AND</span> IDXC<span class="token punctuation">.</span>COLUMN_NAME <span class="token operator">=</span> T<span class="token punctuation">.</span>COLUMN_NAME<span class="token punctuation">)</span>  <span class="token comment">/*过滤掉主键列上的索引*/</span>
<span class="token punctuation">;</span>
</code></pre></div><h4 id="查询数据表自上次统计信息收集以来数据变化量"><a href="#查询数据表自上次统计信息收集以来数据变化量" class="header-anchor">#</a> 查询数据表自上次统计信息收集以来数据变化量</h4> <p>DBA_TAB_MODIFICATIONS记录自上次统计信息收集以来表上的DML操作（INSERT、UPDATE、DELETE）及TRUNCATE操作的历史数据；该视图依赖于后台作业<code>MMON</code>（15min执行一次），手动执行 <code>exec DBMS_STATS.FLUSH_DATABASE_MONITORING_INFO;</code></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 需要启用表监控（激活表修改跟踪）（10g之后，10g之前需手动开启表监控alter table MODIFI_TEST nomonitoring/MONITORING）</span>
<span class="token comment">-- 1. 设置设置统计级别</span>
<span class="token keyword">show</span> parameter statistics_level<span class="token punctuation">;</span>   <span class="token comment">-- 查看参数值</span>
<span class="token comment">--alter system set statistics_level=TYPICAL;   -- 参数设为TYPICAL或ALL</span>
<span class="token comment">--alter session set statistics_level=TYPICAL; </span>


<span class="token comment">-- 查询</span>
<span class="token keyword">SELECT</span> MODIF<span class="token punctuation">.</span>TABLE_OWNER<span class="token punctuation">,</span>
       MODIF<span class="token punctuation">.</span>TABLE_NAME<span class="token punctuation">,</span>
       MODIF<span class="token punctuation">.</span>INSERTS<span class="token punctuation">,</span>
       MODIF<span class="token punctuation">.</span>UPDATES<span class="token punctuation">,</span>
       MODIF<span class="token punctuation">.</span>DELETES<span class="token punctuation">,</span>
       MODIF<span class="token punctuation">.</span><span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span>
       TABS<span class="token punctuation">.</span>LAST_ANALYZED  <span class="token comment">-- 最后分析时间</span>
  <span class="token keyword">FROM</span> DBA_TAB_MODIFICATIONS MODIF
 <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> DBA_TABLES TABS
    <span class="token keyword">ON</span> MODIF<span class="token punctuation">.</span>TABLE_OWNER <span class="token operator">=</span> TABS<span class="token punctuation">.</span>OWNER
   <span class="token operator">AND</span> MODIF<span class="token punctuation">.</span>TABLE_NAME <span class="token operator">=</span> TABS<span class="token punctuation">.</span>TABLE_NAME
 <span class="token keyword">WHERE</span> MODIF<span class="token punctuation">.</span>TABLE_OWNER <span class="token operator">=</span> <span class="token string">'QY_CZB_RZPT_OUT'</span>
   <span class="token operator">AND</span> MODIF<span class="token punctuation">.</span><span class="token keyword">TIMESTAMP</span> <span class="token operator">&gt;=</span> SYSDATE <span class="token operator">-</span> <span class="token keyword">INTERVAL</span> <span class="token string">'30'</span> <span class="token keyword">DAY</span> <span class="token comment">-- 查询最近 1 天内变动的表</span>
 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> MODIF<span class="token punctuation">.</span><span class="token keyword">TIMESTAMP</span> <span class="token keyword">DESC</span>
<span class="token punctuation">;</span>
</code></pre></div><h2 id="与mysql区别"><a href="#与mysql区别" class="header-anchor">#</a> 与MySQL区别</h2> <div class="language-text extra-class"><pre class="language-text"><code>1、oracle是大型数据库，mysql是小型数据库；
2、mysql是主键是支持自动增长类型的（在创建表的时候指定表的主键为auto_increment）,在插入记录时，不需要再指定该记录的主键值，mysql将自动增长；
3、oracle没有自动增长类型主键一般使用序列，在插入记录时，将序列号的下一个值付给该字段即可；
4、mysql可以用双引号包起字符串，而oracle只能用单引号包起。
5、处理分页逻辑不一样，mysql使用limit处理分页；而oracle使用rownum字段标明位置，并且只能用rowNum&amp;lt;100,不能用rowNum&gt;80;
6、mysql定义的空字段里面可以有空的内容，但是oracle种非空字段不能有空的内；
7、两者都能使用like “%字符串%”,但是oracle中使用模糊查询后不能使用索引，速度不快；
8、两者给字段添加注释的方式不一样，

————————————————
原文链接：https://blog.csdn.net/z19950712/article/details/115478505
</code></pre></div><h2 id="shell跑oracle脚本"><a href="#shell跑oracle脚本" class="header-anchor">#</a> Shell跑oracle脚本</h2> <hr> <div class="language-shell script extra-class"><pre class="language-shell"><code><span class="token shebang important">#! /bin/sh</span>
<span class="token assign-left variable">logpath</span><span class="token operator">=</span><span class="token string">&quot;log&quot;</span>
<span class="token assign-left variable">filepath</span><span class="token operator">=</span><span class="token string">&quot;/home/ap/user&quot;</span>
<span class="token comment">#输入Oracle数据库的用户名密码等信息</span>
<span class="token assign-left variable">DBINFO</span><span class="token operator">=</span><span class="token string">&quot;username/password@ip:port/orcl&quot;</span>
<span class="token keyword">if</span>  <span class="token operator">!</span> -d <span class="token variable">${logpath}</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
 <span class="token function">mkdir</span> log
<span class="token keyword">fi</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">`</span><span class="token function">date</span> +<span class="token string">'%Y%m%d %H:%M:%S'</span><span class="token variable">`</span></span>] Info: Begin to execute init sql!&quot;</span>
<span class="token assign-left variable">logfile</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${logpath}</span>/init_table_data_info.log&quot;</span>
<span class="token comment">#“${logfile} 2&gt;&amp;1”这里的意思就是把标准输出信息和错误输出信息都记录在init_table_data_info.log文件中</span>
sqlplus -s <span class="token variable">${DBINFO}</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">!</span> <span class="token operator">&gt;</span> <span class="token variable">${logfile}</span> <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
whenever oserror <span class="token builtin class-name">exit</span> <span class="token number">1</span><span class="token punctuation">;</span>
whenever sqlerror <span class="token builtin class-name">exit</span> <span class="token number">1</span><span class="token punctuation">;</span>
@<span class="token variable">${filepath}</span>/initTable.sql
@<span class="token variable">${filepath}</span>/initTable2.sql
quit
<span class="token operator">!</span>
<span class="token keyword">if</span>  <span class="token variable">$?</span> -ne <span class="token number">0</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">`</span><span class="token function">date</span> +<span class="token string">'%Y%m%d %H:%M:%S'</span><span class="token variable">`</span></span>] Error: Initialize initTable failed!&quot;</span>  <span class="token operator">&gt;&gt;</span> <span class="token variable">${logpath}</span>
    <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable"><span class="token variable">`</span><span class="token function">date</span> +<span class="token string">'%Y%m%d %H:%M:%S'</span><span class="token variable">`</span></span>] Initialize initTable  successed.&quot;</span>  <span class="token operator">&gt;&gt;</span> <span class="token variable">${logpath}</span>
</code></pre></div><h2 id="oracle关联方式-执行计划"><a href="#oracle关联方式-执行计划" class="header-anchor">#</a> Oracle关联方式（执行计划）</h2> <p>为啥有说只有三种的<span style="color:red;">（待完善！！！）</span></p> <blockquote><p>不同数据库支持情况不同：PGSQL支持 nested-loop join 、hash join 、merge join；MySQL只支持 nested-loop join</p></blockquote> <div class="language-text extra-class"><pre class="language-text"><code>Oracle的SQL优化器（Optimizer）在执行多表连接查询时，通常采用的连接算法有以下几种方式：
1、嵌套循环连接（NESTED LOOPS JOIN）
2、哈希连接（HASH JOIN）
3、排序合并连接（SORT MERGE JOIN）
4、笛卡尔连接（CARTESIAN JOIN）
5、群集连接（CLUSTER JOIN）
6、索引连接（INDEX JOIN）
</code></pre></div><p>多表之间的连接有三种方式：Nested Loops，Hash Join 和 Sort Merge Join. 下面来介绍三种不同连接的不同：</p> <p><strong>NESTED LOOP</strong></p> <blockquote><p>对于被连接的数据子集较小的情况，嵌套循环连接是个较好的选择。在嵌套循环中，内表被外表驱动，外表返回的每一行都要在内表中检索找到与它匹配的行，因此整个查询返回的结果集不能太大（大于1 万不适合），要把返回子集较小表的作为外表（CBO 默认外表是驱动表），而且在内表的连接字段上一定要有索引。当然也可以用ORDERED 提示来改变CBO默认的驱动表，使用USE_NL(table_name1 table_name2)可是强制CBO 执行嵌套循环连接。</p></blockquote> <blockquote><p>Nested loop一般用在连接的表中有索引，并且索引选择性较好的时候.</p></blockquote> <blockquote><p>步骤：确定一个驱动表(outer table)，另一个表为inner table，驱动表中的每一行与inner表中的相应记录JOIN。类似一个嵌套的循环。适用于驱动表的记录集比较小（&lt;10000）而且inner表需要有有效的访问方法（Index）。需要注意的是：JOIN的顺序很重要，驱动表的记录集一定要小，返回结果集的响应时间是最快的。</p></blockquote> <p><strong>HASH JOIN</strong></p> <blockquote><p>散列连接是CBO 做大数据集连接时的常用方式，优化器使用两个表中较小的表（或数据源）利用连接键在内存中建立散列表，然后扫描较大的表并探测散列表，找出与散列表匹配的行。
这种方式适用于较小的表完全可以放于内存中的情况，这样总成本就是访问两个表的成本之和。但是在表很大的情况下并不能完全放入内存，这时优化器会将它分割成若干不同的分区，不能放入内存的部分就把该分区写入磁盘的临时段，此时要有较大的临时段从而尽量提高I/O 的性能。
也可以用USE_HASH(table_name1 table_name2)提示来强制使用散列连接。如果使用散列连接HASH_AREA_SIZE 初始化参数必须足够的大，如果是9i，Oracle建议使用SQL工作区自动管理，设置WORKAREA_SIZE_POLICY 为AUTO，然后调整PGA_AGGREGATE_TARGET 即可。</p></blockquote> <blockquote><p>Hash join在两个表的数据量差别很大的时候.</p></blockquote> <blockquote><p>步骤：将两个表中较小的一个在内存中构造一个HASH表（对JOIN KEY），扫描另一个表，同样对JOIN KEY进行HASH后探测是否可以JOIN。适用于记录集比较大的情况。需要注意的是：如果HASH表太大，无法一次构造在内存中，则分成若干个partition，写入磁盘的temporary segment，则会多一个写的代价，会降低效率。</p></blockquote> <p><strong>SORT MERGE JOIN</strong></p> <blockquote><p>通常情况下散列连接的效果都比排序合并连接要好，然而如果行源已经被排过序，在执行排序合并连接时不需要再排序了，这时排序合并连接的性能会优于散列连接。可以使用USE_MERGE(table_name1 table_name2)来强制使用排序合并连接.
Sort Merge join 用在没有索引，并且数据已经排序的情况.
cost = (outer access cost * # of hash partitions) + inner access cost</p></blockquote> <blockquote><p>步骤：将两个表排序，然后将两个表合并。通常情况下，只有在以下情况发生时，才会使用此种JOIN方式：</p> <blockquote><p>1.RBO模式<br>
2.不等价关联(&gt;,&lt;,&gt;=,&lt;=,&lt;&gt;)<br>
3.HASH_JOIN_ENABLED=false<br>
4.数据源已排序</p></blockquote></blockquote> <p><strong>三种连接工作方式比较</strong></p> <blockquote><p>Hash join的工作方式是将一个表（通常是小一点的那个表）做hash运算，将列数据存储到hash列表中，从另一个表中抽取记录，做hash运算，到hash 列表中找到相应的值，做匹配。</p></blockquote> <blockquote><p>Nested loops 工作方式是从一张表中读取数据，访问另一张表（通常是索引）来做匹配，nested loops适用的场合是当一个关联表比较小的时候，效率会更高。</p></blockquote> <blockquote><p>Merge Join 是先将关联表的关联列各自做排序，然后从各自的排序表中抽取数据，到另一个排序表中做匹配，因为merge join需要做更多的排序，所以消耗的资源更多。 通常来讲，能够使用merge join的地方，hash join都可以发挥更好的性能。</p></blockquote> <p><strong>强制使用关联方式</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token comment">/*+use_hash(t,t1) */</span> <span class="token operator">*</span> <span class="token keyword">from</span> scott<span class="token punctuation">.</span>dept t<span class="token punctuation">,</span>scott<span class="token punctuation">.</span>emp t1 <span class="token keyword">where</span> t<span class="token punctuation">.</span>deptno<span class="token operator">=</span>t1<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token comment">/*+use_nl(t,t1) */</span> <span class="token operator">*</span> <span class="token keyword">from</span> scott<span class="token punctuation">.</span>dept t<span class="token punctuation">,</span>scott<span class="token punctuation">.</span>emp t1 <span class="token keyword">where</span> t<span class="token punctuation">.</span>deptno<span class="token operator">=</span>t1<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span>
<span class="token keyword">select</span> <span class="token comment">/*+use_merge(t,t1) */</span> <span class="token operator">*</span> <span class="token keyword">from</span> scott<span class="token punctuation">.</span>dept t<span class="token punctuation">,</span>scott<span class="token punctuation">.</span>emp t1 <span class="token keyword">where</span> t<span class="token punctuation">.</span>deptno<span class="token operator">=</span>t1<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span>
</code></pre></div><p><a href="https://blog.csdn.net/tianlesoftware/article/details/5826546" target="_blank" rel="noopener noreferrer">原文链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="点状知识"><a href="#点状知识" class="header-anchor">#</a> 点状知识</h2> <h3 id="匹配中文"><a href="#匹配中文" class="header-anchor">#</a> 匹配中文</h3> <div class="language-sql extra-class"><pre class="language-sql"><code>使用正则匹配不太好使

替换方案：chr<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">-</span> chr<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> 可以匹配双字节字符（同样不够准确）
<span class="token keyword">select</span> regexp_replace<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'['</span><span class="token operator">||</span>chr<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token operator">||</span> <span class="token string">'-'</span> <span class="token operator">||</span> chr<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">||</span><span class="token string">']'</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual<span class="token punctuation">;</span>
</code></pre></div><h3 id="创建dblink"><a href="#创建dblink" class="header-anchor">#</a> 创建DBLink</h3> <blockquote><p>注：由于 dblink 跨库查询是把一个数据库数据通过网络发送到另一数据库关联查询，
可以通过指定 hint <code>/*+ driving_site(t)*/</code> 指定驱动表（t 一般是大表），从而减少网络传输。
当然，最终效率还是要综合磁盘IO、网络IO和计算能力等综合考虑</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- Create database link </span>
<span class="token keyword">create</span> <span class="token keyword">public</span> <span class="token keyword">database</span> link <span class="token operator">&lt;</span>dblink名<span class="token operator">&gt;</span>
  <span class="token keyword">connect</span> <span class="token keyword">to</span> <span class="token operator">&lt;</span>用户名<span class="token operator">&gt;</span>
  IDENTIFIED <span class="token keyword">BY</span> <span class="token operator">&lt;</span><span class="token string">&quot;密码&quot;</span><span class="token operator">&gt;</span>
  <span class="token keyword">using</span> <span class="token string">'(DESCRIPTION =(ADDRESS_LIST =(ADDRESS =(PROTOCOL=TCP)(HOST=&lt;ip&gt;)(PORT=&lt;端口&gt;)))(CONNECT_DATA=(SERVICE_NAME=orcl)))'</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="sql并行"><a href="#sql并行" class="header-anchor">#</a> SQL并行</h3> <p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/12.2/sqlrf/Comments.html#GUID-D316D545-89E2-4D54-977F-FC97815CD62E" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="http://blog.itpub.net/25542870/viewspace-2120924/" target="_blank" rel="noopener noreferrer">原文地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>1.查询开启并行（Parallel query）</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token comment">/*+parallel(a, 16)*/</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">from</span> dual a<span class="token punctuation">;</span>     <span class="token comment">-- 第一种方式（Hist方式）</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> tab1 parallel n<span class="token punctuation">;</span>                          <span class="token comment">-- 第二种方式</span>
<span class="token keyword">alter</span> <span class="token keyword">session</span> <span class="token keyword">force</span> parallel query parallel n<span class="token punctuation">;</span>        <span class="token comment">-- 第三种方式</span>
</code></pre></div><ul><li>2.修改数据开启并行（Parallel DML (INSERT, UPDATE, DELETE, and MERGE) ）</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 第一种方式（Hist方式）</span>
<span class="token keyword">UPDATE</span> <span class="token comment">/*+ PARALLEL(tab1,4) */</span> tbl_2 <span class="token keyword">SET</span> c1<span class="token operator">=</span>c1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token comment">/*+ PARALLEL(tbl_ins,2) */</span> <span class="token keyword">INTO</span> tbl_ins
<span class="token keyword">SELECT</span> <span class="token comment">/*+ PARALLEL(tbl_sel,4) */</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> tbl_sel<span class="token punctuation">;</span>
<span class="token keyword">DELETE</span> <span class="token comment">/*+ PARALLEL (t1, 2) */</span> <span class="token keyword">FROM</span> t1

<span class="token comment">-- 第二种方式</span>
<span class="token keyword">alter</span> <span class="token keyword">session</span> <span class="token keyword">force</span> parallel DML parallel n<span class="token punctuation">;</span>

<span class="token comment">-- 第三种方式</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> tab1 parallel n<span class="token punctuation">;</span>
</code></pre></div><ul><li>3.Parallel DDL</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 第一种方式（Hist方式）</span>
<span class="token keyword">ALTER</span> <span class="token keyword">SESSION</span> <span class="token keyword">FORCE</span> PARALLEL DDL parallel n<span class="token punctuation">;</span>

<span class="token comment">-- 第二种方式</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> …<span class="token punctuation">.</span>parallel <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">INDEX</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> REBUILD parallel <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">INDEX</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> MOVE <span class="token keyword">PARTITION</span> parallel <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">ALTER</span> <span class="token keyword">INDEX</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>SPLIT <span class="token keyword">PARTITION</span> parallel <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>附：存储过程中开启并行</li></ul> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">declare</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">begin</span>
 <span class="token keyword">execute</span> immediate <span class="token string">'alter session force parallel dml parallel  8'</span><span class="token punctuation">;</span>
 <span class="token comment">--更新操作</span>
 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
 <span class="token keyword">commit</span><span class="token punctuation">;</span> <span class="token comment">--必须先commit,否则会报 ora-12841</span>
 <span class="token keyword">execute</span> immediate <span class="token string">'alter session disable parallel dml '</span><span class="token punctuation">;</span>

exception
 <span class="token keyword">when</span> others <span class="token keyword">then</span>
   <span class="token keyword">rollback</span><span class="token punctuation">;</span>
   <span class="token keyword">execute</span> immediate <span class="token string">'alter session disable parallel dml '</span><span class="token punctuation">;</span> 
<span class="token keyword">end</span><span class="token punctuation">;</span>
</code></pre></div><p>注：使用临时表with as时不能使用并行（比如：在存储过程中开启session并行），否则会导致结果不一致</p> <h3 id="中文排序方式"><a href="#中文排序方式" class="header-anchor">#</a> 中文排序方式</h3> <div class="language-sql extra-class"><pre class="language-sql"><code>Oracle9i之前，中文是按照二进制编码进行排序的。
在oracle9i中新增了按照拼音、部首、笔画排序功能。设置NLS_SORT值

SCHINESE_RADICAL_M 按照部首<span class="token punctuation">(</span>第一顺序<span class="token punctuation">)</span>、笔划<span class="token punctuation">(</span>第二顺序<span class="token punctuation">)</span>排序
SCHINESE_STROKE_M 按照笔划<span class="token punctuation">(</span>第一顺序<span class="token punctuation">)</span>、部首<span class="token punctuation">(</span>第二顺序<span class="token punctuation">)</span>排序
SCHINESE_PINYIN_M 按照拼音排序

修改ORACLE字段的默认排序方式：
按拼音<span class="token punctuation">(</span>默认<span class="token punctuation">)</span>：
<span class="token keyword">alter</span> <span class="token keyword">session</span> <span class="token keyword">set</span> nls_sort <span class="token operator">=</span> SCHINESE_PINYIN_M<span class="token punctuation">;</span>
按笔画：
<span class="token keyword">alter</span> <span class="token keyword">session</span> <span class="token keyword">set</span> nls_sort <span class="token operator">=</span> SCHINESE_STROKE_M<span class="token punctuation">;</span>
按偏旁：
<span class="token keyword">alter</span> <span class="token keyword">session</span> <span class="token keyword">set</span> nls_sort <span class="token operator">=</span> NLS_SORT<span class="token operator">=</span>SCHINESE_RADICAL_M<span class="token punctuation">;</span>

NLSSORT<span class="token punctuation">(</span><span class="token punctuation">)</span>，用来进行语言排序

示例:
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> TEAM <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> NLSSORT<span class="token punctuation">(</span>排序字段名<span class="token punctuation">,</span><span class="token string">'NLS_SORT =SCHINESE_PINYIN_M'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="数据中包含特殊符号需要转义"><a href="#数据中包含特殊符号需要转义" class="header-anchor">#</a> 数据中包含特殊符号需要转义</h3> <ol><li>执行语句前先执行 <code>set define off;</code> （去掉oracle自定义的字符含义，还原它本来的意思）</li> <li>使用ASCII编码对 &amp; 进行转义 chr(38)  <code>select 'xxx?xxx=11' || chr(38) || 'xxx=33' from dual</code></li> <li>不转义，直接字符串的形式写进去 <code>select 'xxx?xxx=11' || '&amp;' || 'xxx=33' from dual</code></li></ol> <h3 id="数据泵导入导出-待完善"><a href="#数据泵导入导出-待完善" class="header-anchor">#</a> 数据泵导入导出（待完善）</h3> <p><strong>导入：首先我们需要知道导出用户和表空间的名字</strong></p> <p>注意：1. 如果表空间不是只有一个，需要使用remap_tablespace指定到我们创建的表空间 2. 单个表空间文件最大32G</p> <blockquote><p>所以拿到导出log文件是非常有必要的</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 创建表空间  UNLIMITED指定不限制最大表空间</span>
<span class="token keyword">create</span> <span class="token keyword">TABLESPACE</span> BANANA datafile <span class="token string">'E:\OracleData\tablespace\DATAS.dbf'</span> size <span class="token number">50</span>m autoextend <span class="token keyword">on</span> <span class="token keyword">next</span> <span class="token number">50</span>m MAXSIZE UNLIMITED extent management <span class="token keyword">local</span><span class="token punctuation">;</span> 
<span class="token comment">-- 删除表空间</span>
<span class="token keyword">drop</span> <span class="token keyword">TABLESPACE</span> BANANA including contents <span class="token operator">and</span> datafiles <span class="token keyword">cascade</span> constraints<span class="token punctuation">;</span>
<span class="token comment">-- 查询表空间</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dba_tablespaces<span class="token punctuation">;</span>


<span class="token comment">-- 管理员登录，创建新用户，分配已创建好的表空间</span>
<span class="token keyword">create</span> <span class="token keyword">user</span> banana identified <span class="token keyword">BY</span> banana <span class="token keyword">default</span> <span class="token keyword">TABLESPACE</span> BANANA<span class="token punctuation">;</span>
<span class="token comment">-- 删除用户带级联</span>
<span class="token keyword">drop</span> <span class="token keyword">user</span> banana <span class="token keyword">cascade</span><span class="token punctuation">;</span>


<span class="token comment">-- 授权</span>
<span class="token keyword">Grant</span> dba <span class="token keyword">to</span> banana <span class="token keyword">with</span> admin <span class="token keyword">option</span><span class="token punctuation">;</span>


<span class="token comment">-- 查询dup存放目录目录    注意：后面的E盘下面的dpdump 必须把你要导入的xxx.dmp文件放进该文件夹  DATA_PUMP_DIR</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dba_directories<span class="token punctuation">;</span>
<span class="token comment">-- 数据泵导入数据 (CMD命令行   DATA_PUMP_DIR为上面查出的目录名  如果有其他表空间的，需要使用remap_tablespace指定到我们创建的表空间)</span>
impdp banana remap_tablespace<span class="token operator">=</span>MOF:BANANA<span class="token punctuation">,</span>TEST:BANANA directory<span class="token operator">=</span>DATA_PUMP_DIR <span class="token keyword">dumpfile</span><span class="token operator">=</span>XXX<span class="token punctuation">.</span>DMP logfile<span class="token operator">=</span>impdp<span class="token punctuation">.</span>log <span class="token comment">-- FULL=YES parallel=16</span>


<span class="token comment">-- 增加指定表空间文件（单个表空间文件最大32G，需要扩充）</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLESPACE</span> BANANA <span class="token keyword">ADD</span> DATAFILE <span class="token string">'E:\OracleData\tablespace\DATAS01.dbf'</span> SIZE <span class="token number">100</span>M AUTOEXTEND <span class="token keyword">ON</span> <span class="token keyword">NEXT</span> <span class="token number">50</span>M  <span class="token punctuation">;</span>
</code></pre></div><p><strong>导入导出实操过程命令保存</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 导出命令</span>
expdp username<span class="token operator">/</span>passwd<span class="token variable">@ip</span>:port<span class="token operator">/</span>lgfv directory<span class="token operator">=</span>DATA_PUMP_DIR <span class="token keyword">dumpfile</span><span class="token operator">=</span>xxx<span class="token punctuation">.</span>dmp logfile<span class="token operator">=</span>xxx<span class="token punctuation">.</span>log schemas<span class="token operator">=</span>username
<span class="token comment">-- 导出后对数据包进行压缩（WinRAR工具分卷压缩）！！！减少网络传输</span>

<span class="token comment">-- 表空间创建（确定表空间足够，一个文件最大32G）</span>
<span class="token comment">-- create TABLESPACE RZPT datafile 'D:\APP\ADMINISTRATOR\ORADATA\ORCL\RZPT01.dbf' size 100m autoextend on next 100m MAXSIZE UNLIMITED extent management local; </span>
<span class="token comment">-- ALTER TABLESPACE RZPT ADD DATAFILE 'D:\APP\ADMINISTRATOR\ORADATA\ORCL\RZPT02.dbf' SIZE 100M AUTOEXTEND ON NEXT 100M  ;</span>

<span class="token comment">-- 创建用户并授权</span>
<span class="token keyword">create</span> <span class="token keyword">user</span> username2 identified <span class="token keyword">BY</span> passwd2 <span class="token keyword">default</span> <span class="token keyword">TABLESPACE</span> RZPT<span class="token punctuation">;</span>
<span class="token keyword">Grant</span> dba <span class="token keyword">to</span> username2 <span class="token keyword">with</span> admin <span class="token keyword">option</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询原库用到的表空间</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> TABLESPACE_NAME
<span class="token keyword">FROM</span> DBA_SEGMENTS
<span class="token keyword">WHERE</span> OWNER <span class="token operator">=</span> <span class="token string">'username'</span><span class="token punctuation">;</span>

<span class="token comment">-- 导入命令</span>
impdp username2<span class="token operator">/</span>passwd2<span class="token variable">@localhost</span><span class="token operator">/</span>orcl DIRECTORY<span class="token operator">=</span>DATA_PUMP_DIR <span class="token keyword">DUMPFILE</span><span class="token operator">=</span>xxx<span class="token punctuation">.</span>DMP remap_schema<span class="token operator">=</span>username:username2 remap_tablespace<span class="token operator">=</span>DSY:RZPT<span class="token punctuation">,</span>CS_CZB_RZPT:RZPT LOGFILE<span class="token operator">=</span>xxx<span class="token punctuation">.</span>log parallel<span class="token operator">=</span><span class="token number">4</span>

<span class="token comment">-- 附：删除用户报有连接  查询会话并杀死</span>
<span class="token keyword">SELECT</span> s<span class="token punctuation">.</span>sid<span class="token punctuation">,</span> s<span class="token punctuation">.</span><span class="token keyword">serial</span><span class="token comment">#, s.username, s.status, p.spid</span>
<span class="token keyword">FROM</span> v$<span class="token keyword">session</span> s<span class="token punctuation">,</span> v$process p
<span class="token keyword">WHERE</span> s<span class="token punctuation">.</span>paddr <span class="token operator">=</span> p<span class="token punctuation">.</span>addr <span class="token operator">AND</span> s<span class="token punctuation">.</span>username <span class="token operator">=</span> <span class="token string">'username'</span><span class="token punctuation">;</span>
<span class="token comment">-- ALTER SYSTEM KILL SESSION '143,46649' ;</span>

<span class="token comment">-- 附：若导入卡在 处理对象类型 SCHEMA_EXPORT/TABLE/INDEX/INDEX 不动；</span>
<span class="token comment">-- 查看日志</span>
<span class="token keyword">show</span> parameter <span class="token keyword">dump</span> <span class="token comment">-- 命令行执行，查看日志位置</span>
<span class="token comment">-- 查看 alert_orcl.log 若日志有相关提示</span>
<span class="token keyword">select</span> <span class="token keyword">group</span><span class="token comment">#,sequence#,bytes,members,status from v$log;   </span>
<span class="token keyword">alter</span> <span class="token keyword">database</span> <span class="token keyword">add</span> logfile <span class="token keyword">group</span> <span class="token number">4</span> <span class="token punctuation">(</span><span class="token string">'D:\APP\ADMINISTRATOR\ORADATA\ORCL\REDO04.LOG'</span><span class="token punctuation">)</span> size <span class="token number">200</span>M<span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">database</span> <span class="token keyword">add</span> logfile <span class="token keyword">group</span> <span class="token number">5</span> <span class="token punctuation">(</span><span class="token string">'D:\APP\ADMINISTRATOR\ORADATA\ORCL\REDO05.LOG'</span><span class="token punctuation">)</span> size <span class="token number">1</span>G<span class="token punctuation">;</span>
<span class="token keyword">alter</span> system switch logfile<span class="token punctuation">;</span>
<span class="token comment">-- ALTER DATABASE DROP LOGFILE GROUP 4;   -- 删除旧组</span>
</code></pre></div><p><strong>报错处理</strong></p> <ol><li>ORA-39083: ORA-14460: 只能指定一个 COMPRESS 或 NOCOMPRESS 子句，导入命令加参数 <code>transform=segment_attributes:n</code> （未实测）</li></ol> <p><strong>命令保存</strong></p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 创建目录</span>
<span class="token keyword">create</span> directory my_dir <span class="token keyword">as</span> <span class="token string">'/home/oracle/tmp'</span><span class="token punctuation">;</span>
<span class="token keyword">grant</span> <span class="token keyword">read</span><span class="token punctuation">,</span><span class="token keyword">write</span> <span class="token keyword">on</span> directory my_dir <span class="token keyword">to</span> username<span class="token punctuation">;</span>

<span class="token comment">-- 环境变量(若没配置好，需先执行)   若不搞好容易表注释乱码！！！</span>
export ORACLE_HOME<span class="token operator">=</span><span class="token operator">/</span>xxx<span class="token operator">/</span>oracle<span class="token operator">/</span>product<span class="token operator">/</span><span class="token number">11.2</span><span class="token number">.0</span><span class="token operator">/</span>dbhome_1
export ORACLE_SID<span class="token operator">=</span>orcl
export PATH<span class="token operator">=</span>$ORACLE_HOME<span class="token operator">/</span>bin:$PATH
export NLS_LANG<span class="token operator">=</span>AMERICAN_AMERICA<span class="token punctuation">.</span>ZHS16GBK

<span class="token comment">-- exp/imp 导入导出指定表</span>
exp 导出用户名<span class="token operator">/</span><span class="token string">'密码'</span><span class="token variable">@orcl</span> <span class="token keyword">file</span><span class="token operator">=</span><span class="token operator">/</span>home<span class="token operator">/</span>oracle<span class="token operator">/</span>xxx<span class="token punctuation">.</span>dmp <span class="token keyword">tables</span><span class="token operator">=</span>\<span class="token punctuation">(</span>tablename1<span class="token punctuation">,</span> tablename2\<span class="token punctuation">)</span> log<span class="token operator">=</span><span class="token operator">/</span>home<span class="token operator">/</span>oracle<span class="token operator">/</span>xxx<span class="token punctuation">.</span>log schemas<span class="token operator">=</span>scott
imp 导入用户名<span class="token operator">/</span><span class="token string">'密码'</span><span class="token variable">@orcl</span> <span class="token keyword">file</span><span class="token operator">=</span><span class="token operator">/</span>home<span class="token operator">/</span>oracle<span class="token operator">/</span>xxx<span class="token punctuation">.</span>dmp <span class="token keyword">tables</span><span class="token operator">=</span>\<span class="token punctuation">(</span>tablename1<span class="token punctuation">,</span> tablename2\<span class="token punctuation">)</span> log<span class="token operator">=</span><span class="token operator">/</span>home<span class="token operator">/</span>oracle<span class="token operator">/</span>xxx<span class="token punctuation">.</span>log <span class="token keyword">statistics</span><span class="token operator">=</span>none schemas<span class="token operator">=</span>scott


<span class="token comment">-- expdp/impdp 导入导出 </span>
expdp $USERNAME<span class="token operator">/</span>$PASSWD <span class="token keyword">DUMPFILE</span><span class="token operator">=</span>xxx<span class="token punctuation">.</span>dmp<span class="token punctuation">(</span>据说可以为任意后缀名<span class="token punctuation">)</span> DIRECTORY<span class="token operator">=</span>DATA_PUMP_DIR<span class="token punctuation">(</span>Oracle内变量<span class="token punctuation">)</span> <span class="token keyword">FULL</span><span class="token operator">=</span>y LOGFILE<span class="token operator">=</span>xxx<span class="token punctuation">.</span>log schemas<span class="token operator">=</span>scott
impdp $USERNAME<span class="token operator">/</span>$PASSWD directory<span class="token operator">=</span>DATA_PUMP_DIR <span class="token keyword">dumpfile</span><span class="token operator">=</span>xxx<span class="token punctuation">.</span>dmp logfile<span class="token operator">=</span>xxx<span class="token punctuation">.</span>log <span class="token keyword">full</span><span class="token operator">=</span>yes schemas<span class="token operator">=</span>scott
expdp $USERNAME<span class="token operator">/</span>$PASSWD <span class="token keyword">DUMPFILE</span><span class="token operator">=</span>xxx<span class="token punctuation">.</span>dmp DIRECTORY<span class="token operator">=</span>DATA_PUMP_DIR LOGFILE<span class="token operator">=</span>xxx<span class="token punctuation">.</span>log <span class="token keyword">tables</span><span class="token operator">=</span>\<span class="token punctuation">(</span>tablename1<span class="token punctuation">,</span> tablename2\<span class="token punctuation">)</span> schemas<span class="token operator">=</span>scott
impdp $USERNAME<span class="token operator">/</span>$PASSWD directory<span class="token operator">=</span>DATA_PUMP_DIR <span class="token keyword">dumpfile</span><span class="token operator">=</span>xxx<span class="token punctuation">.</span>dmp logfile<span class="token operator">=</span>xxx<span class="token punctuation">.</span>log <span class="token keyword">tables</span><span class="token operator">=</span>\<span class="token punctuation">(</span>tablename1<span class="token punctuation">,</span> tablename2\<span class="token punctuation">)</span> schemas<span class="token operator">=</span>scott

<span class="token comment">-- 参数</span>
parallel<span class="token operator">=</span><span class="token number">5</span> <span class="token comment">-- 并行导出</span>
content<span class="token operator">=</span>metadata_only <span class="token comment">-- 元数据(包含表定义、存储过程、函数等等)</span>
include<span class="token operator">=</span>\<span class="token punctuation">(</span><span class="token keyword">procedure</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">,</span><span class="token keyword">view</span>\<span class="token punctuation">)</span>
exclude<span class="token operator">=</span><span class="token keyword">index</span>  <span class="token comment">-- 排除</span>

<span class="token comment">------------------------------------------ 导出 ------------------------------------------------</span>
<span class="token comment">##导出一张表，例：</span>
expdp system<span class="token operator">/</span>oracle directory<span class="token operator">=</span>my_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp logfile<span class="token operator">=</span>expdp<span class="token punctuation">.</span>log <span class="token keyword">tables</span><span class="token operator">=</span>scott<span class="token punctuation">.</span>emp schemas<span class="token operator">=</span>scott

<span class="token comment">##导出多张表，例：</span>
expdp system<span class="token operator">/</span>oracle directory<span class="token operator">=</span>my_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp logfile<span class="token operator">=</span>expdp<span class="token punctuation">.</span>log <span class="token keyword">tables</span><span class="token operator">=</span>\<span class="token punctuation">(</span>scott<span class="token punctuation">.</span>emp<span class="token punctuation">,</span>scott<span class="token punctuation">.</span>dept\<span class="token punctuation">)</span> schemas<span class="token operator">=</span>scott

<span class="token comment">##导出一个用户(导出这个用户的所有对象)，例：</span>
expdp system<span class="token operator">/</span>oracle directory<span class="token operator">=</span>my_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp logfile<span class="token operator">=</span>expdp<span class="token punctuation">.</span>log schemas<span class="token operator">=</span>scott

<span class="token comment">##导出多个用户，例：</span>
expdp system<span class="token operator">/</span>oracle directory<span class="token operator">=</span>my_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp logfile<span class="token operator">=</span>expdp<span class="token punctuation">.</span>log schemas<span class="token operator">=</span>\<span class="token punctuation">(</span>scott<span class="token punctuation">,</span>hr\<span class="token punctuation">)</span>

<span class="token comment">##导出整个数据库（sys、ordsys、mdsys的用户数据不会被导出）例：</span>
expdp system<span class="token operator">/</span>oracle directory<span class="token operator">=</span>my_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp logfile<span class="token operator">=</span>expdp<span class="token punctuation">.</span>log <span class="token keyword">full</span><span class="token operator">=</span>yes

<span class="token comment">------------------------------------------ 导入 ------------------------------------------------</span>
<span class="token comment">##导入dmp文件中的所有数据，例：</span>
impdp system<span class="token operator">/</span>oracle directory<span class="token operator">=</span>my_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp logfile<span class="token operator">=</span>impdp<span class="token punctuation">.</span>log <span class="token keyword">full</span><span class="token operator">=</span>yes schemas<span class="token operator">=</span>scott

<span class="token comment">##导入一张表，例：</span>
impdp system<span class="token operator">/</span>oracle directory<span class="token operator">=</span>my_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp logfile<span class="token operator">=</span>impdp<span class="token punctuation">.</span>log <span class="token keyword">tables</span><span class="token operator">=</span>scott<span class="token punctuation">.</span>emp schemas<span class="token operator">=</span>scott

<span class="token comment">##导入多张表，例：</span>
impdp system<span class="token operator">/</span>oracle directory<span class="token operator">=</span>my_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp logfile<span class="token operator">=</span>impdp<span class="token punctuation">.</span>log <span class="token keyword">tables</span><span class="token operator">=</span>\<span class="token punctuation">(</span>scott<span class="token punctuation">.</span>emp<span class="token punctuation">,</span>scott<span class="token punctuation">.</span>dept\<span class="token punctuation">)</span> schemas<span class="token operator">=</span>scott

<span class="token comment">##导入一个用户，例：</span>
impdp system<span class="token operator">/</span>oracle directory<span class="token operator">=</span>my_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp logfile<span class="token operator">=</span>impdp<span class="token punctuation">.</span>log schemas<span class="token operator">=</span>scott

<span class="token comment">##导入多个用户，例：</span>
impdp system<span class="token operator">/</span>oracle directory<span class="token operator">=</span>my_dir <span class="token keyword">dumpfile</span><span class="token operator">=</span>expdp<span class="token punctuation">.</span>dmp logfile<span class="token operator">=</span>impdp<span class="token punctuation">.</span>log schemas<span class="token operator">=</span>\<span class="token punctuation">(</span>scott<span class="token punctuation">,</span>hr\<span class="token punctuation">)</span>
</code></pre></div><h3 id="oracle-高版本导出-低版本导入-修改版本号"><a href="#oracle-高版本导出-低版本导入-修改版本号" class="header-anchor">#</a> Oracle 高版本导出，低版本导入，修改版本号</h3> <ol><li>使用 AlexTools 工具</li> <li>导出时指定版本，增加参数（例：version=11.2）</li></ol> <h3 id="redolog-导库、大批量、长事务是不是需要调整"><a href="#redolog-导库、大批量、长事务是不是需要调整" class="header-anchor">#</a> REDOLOG（导库、大批量、长事务是不是需要调整？）</h3> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">show</span> parameter <span class="token keyword">dump</span> <span class="token comment">-- 命令行执行，查看日志位置</span>

<span class="token keyword">select</span> <span class="token keyword">group</span><span class="token comment">#,sequence#,bytes,members,status from v$log;   --查询日志组</span>
<span class="token keyword">SELECT</span> <span class="token keyword">GROUP</span><span class="token comment">#, MEMBER FROM V$LOGFILE;  -- 查看成员文件路径。</span>

<span class="token comment">-- 增加日志文件</span>
<span class="token keyword">alter</span> <span class="token keyword">database</span> <span class="token keyword">add</span> logfile <span class="token keyword">group</span> <span class="token number">4</span> <span class="token punctuation">(</span><span class="token string">'D:\APP\ADMINISTRATOR\ORADATA\ORCL\REDO04.LOG'</span><span class="token punctuation">)</span> size <span class="token number">200</span>M<span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">database</span> <span class="token keyword">add</span> logfile <span class="token keyword">group</span> <span class="token number">5</span> <span class="token punctuation">(</span><span class="token string">'D:\APP\ADMINISTRATOR\ORADATA\ORCL\REDO05.LOG'</span><span class="token punctuation">)</span> size <span class="token number">1</span>G<span class="token punctuation">;</span>
<span class="token comment">-- ALTER DATABASE ADD LOGFILE GROUP 4 ('/u01/oradata/redo04a.log', '/u02/oradata/redo04b.log') SIZE 200M;</span>


<span class="token comment">-- 切换日志文件</span>
<span class="token keyword">alter</span> system switch logfile<span class="token punctuation">;</span>

<span class="token comment">-- ALTER DATABASE DROP LOGFILE GROUP 4;   -- 删除旧组 删除后需手动清理物理文件</span>
    
<span class="token comment">-- 查询REDOLOG切换次数</span>
<span class="token keyword">SELECT</span> trunc<span class="token punctuation">(</span>first_time<span class="token punctuation">)</span> <span class="token string">&quot;Date&quot;</span><span class="token punctuation">,</span>
       to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'Dy'</span><span class="token punctuation">)</span> <span class="token string">&quot;Day&quot;</span><span class="token punctuation">,</span>
       <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;Total&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'00'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h0&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'01'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h1&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'02'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h2&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'03'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h3&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'04'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h4&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'05'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h5&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'06'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h6&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'07'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h7&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'08'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h8&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'09'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h9&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'10'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h10&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'11'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h11&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'12'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h12&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'13'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h13&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'14'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h14&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'15'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h15&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'16'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h16&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'17'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h17&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'18'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h18&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'19'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h19&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'20'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h20&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'21'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h21&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'22'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h22&quot;</span><span class="token punctuation">,</span>
       <span class="token function">SUM</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'hh24'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'23'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token string">&quot;h23&quot;</span>
  <span class="token keyword">FROM</span> V$log_history
 <span class="token keyword">WHERE</span> FIRST_TIME <span class="token operator">&gt;=</span> TRUNC<span class="token punctuation">(</span>SYSDATE<span class="token punctuation">,</span> <span class="token string">'MM'</span><span class="token punctuation">)</span>
 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> trunc<span class="token punctuation">(</span>first_time<span class="token punctuation">)</span><span class="token punctuation">,</span> to_char<span class="token punctuation">(</span>first_time<span class="token punctuation">,</span> <span class="token string">'Dy'</span><span class="token punctuation">)</span>
 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token number">1</span> <span class="token keyword">DESC</span>
<span class="token punctuation">;</span>
</code></pre></div><h3 id="解决本地oracle服务内存占用过高"><a href="#解决本地oracle服务内存占用过高" class="header-anchor">#</a> 解决本地Oracle服务内存占用过高</h3> <p><strong>Oracle安装时，为均衡电脑性能和数据库性能，默认内存大小为物理内存的1/8</strong></p> <ol><li>用dba身份进入oracle</li> <li>show parameter sga; --显示内存分配情况</li> <li>alter system set sga_target=1024m scope=spfile;-修改target大小 //这个值必须小于等于sga_max_size ，否则库会起不来；</li> <li>alter system set sga_max_size=1024m scope=spfile; --修改最大占用内存的大小</li> <li>修改后重启Oracle服务</li> <li>附：Oracle服务介绍 <a href="https://blog.csdn.net/Ren_gw/article/details/84592715" target="_blank" rel="noopener noreferrer">原文链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>Oracle ORCL VSS Writer Service：Oracle卷映射拷贝写入服务，VSS（Volume Shadow Copy Service）能够让存储基础设备（比如磁盘，阵列等）创建高保真的时间点映像，即映射拷贝（shadow copy）。它可以在多卷或者单个卷上创建映射拷贝，同时不会影响到系统的系统能。<span style="color:red;">（非必须启动）</span></li> <li>OracleDBConsoleorcl：Oracle数据库控制台服务，orcl是Oracle的实例标识，默认的实例为orcl。在运行Enterprise Manager（企业管理器OEM）的时候，需要启动这个服务。<span style="color:red;">（非必须启动）</span></li> <li>OracleJobSchedulerORCL：Oracle作业调度（定时器）服务，ORCL是Oracle实例标识。<span style="color:red;">（非必须启动）</span></li> <li>OracleMTSRecoveryService：服务端控制。该服务允许数据库充当一个微软事务服务器MTS、COM/COM+对象和分布式环境下的事务的资源管理器。<span style="color:red;">（非必须启动）</span></li> <li>OracleOraDb11g_home1ClrAgent：Oracle数据库  .NET扩展服务的一部分。 <span style="color:red;">（非必须启动）</span></li> <li>OracleOraDb11g_home1TNSListener：监听器服务，服务只有在数据库需要远程访问的时候才需要。<span style="color:red;">（非必须启动但很常用）</span></li> <li>OracleServiceORCL：数据库服务(数据库实例)，是Oracle核心服务，该服务是数据库启动的基础， 只有该服务启动，Oracle数据库才能正常启动。<span style="color:red;">(必须启动)</span></li></ul></li></ol> <h3 id="数据插入慢的问题"><a href="#数据插入慢的问题" class="header-anchor">#</a> 数据插入慢的问题</h3> <p><strong>新增：晚上跑存储过程稍快（好几个表两千多万条数据4688s），为什么？因为磁盘读写速度慢T.T</strong></p> <ol><li>有个九百多万数据的表需要重新抽数（抽数速度极其慢，后发现是索引导致的，不清楚是索引有问题还是正常现象（索引增加查询速率但影响insert、update、delete效率），<span style="color:red;font-weight:bold;">应该先删除索引再抽数</span>）
<blockquote><p>没删除索引前的效率： 【345430 条数据花费 1406s】【345430 条数据花费1301s】<br>
删除后的效率：【345508条数据花费 64s】【345482 条数据花费 7.248s】【345508 条数据34.466s】【datax：1641410条数据465s】</p></blockquote></li></ol></div></div> <div class="page-slot page-slot-bottom">
  <div class="wwads-cn wwads-horizontal pageB" data-id="136" style="width:100%;max-height:80px;min-height:auto;"></div>
  <style>
    .pageB img{width:80px!important;}
    .wwads-horizontal .wwads-text, .wwads-content .wwads-text{line-height:1;}
  </style>
  </div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/user-h/hdata-doc/edit/master/docs/03.数据库/01.Oracle/01.Oracle相关知识杂记.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/04/22, 10:19:39</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/hdata-doc/pages/b5c27a/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">系统函数篇</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/hdata-doc/pages/b5c27a/">系统函数篇</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:1033078928@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/user-h" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://gitee.com/aihb" title="Gitee" target="_blank" class="iconfont icon-gitee"></a><a href="https://music.163.com" title="听音乐" target="_blank" class="iconfont icon-erji"></a><a href="https://bilibili.com" title="哔哩哔哩" target="_blank" class="iconfont icon-bilibili"></a><a href="https://douyin.com/" title="抖音" target="_blank" class="iconfont icon-douyin"></a><a href="" title="猫咪" target="_blank" class="iconfont icon-mao"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2025
    <span>Ai | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><span class="close-but">×</span> <div>
    <div class="wwads-cn wwads-vertical windowRB" data-id="136" style="max-width:160px;
    min-width: auto;min-height:auto;"></div>
    <style>
      .windowRB{ padding: 0;}
      .windowRB .wwads-img{margin-top: 10px;}
      .windowRB .wwads-content{margin: 0 10px 10px 10px;}
      .custom-html-window-rb .close-but{
        display: none;
      }
    </style>
  </div></div></div></div><div class="global-ui"></div></div>
    <script src="/hdata-doc/assets/js/app.37e4fbb6.js" defer></script><script src="/hdata-doc/assets/js/2.82afd9cb.js" defer></script><script src="/hdata-doc/assets/js/54.ed81b599.js" defer></script>
  </body>
</html>
